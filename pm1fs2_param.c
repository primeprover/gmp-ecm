/* 
  Implementation of fast stage 2 for P-1 and P+1 as described in
  "Improved Stage 2 to $P\pm{}1$ Factoring Algorithms" by
  Peter L. Montgomery and Alexander Kruppa, ANTS 2008 (8th Algorithmic 
  Number Theory Symposium).
   
  Copyright 2007, 2008 Alexander Kruppa.
  NTT functions are based on code Copyright 2005 Dave Newman.

  This file is part of the ECM Library.

  The ECM Library is free software; you can redistribute it and/or modify
  it under the terms of the GNU Lesser General Public License as published by
  the Free Software Foundation; either version 2.1 of the License, or (at your
  option) any later version.

  The ECM Library is distributed in the hope that it will be useful, but
  WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
  or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public
  License for more details.

  You should have received a copy of the GNU Lesser General Public License
  along with the ECM Library; see the file COPYING.LIB.  If not, write to
  the Free Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston,
  MA 02110-1301, USA.
*/

#include "config.h"
#include <stdio.h>
#include <stdlib.h>
#include <limits.h>
#include "ecm-impl.h"
#include "sp.h"
#include <math.h>

/* Some useful PARI functions:
   sumset(a,b) = {local(i, j, l); l = listcreate (length(a) * length(b)); for 
(i = 1, length(a), for (j = 1, length(b), listput(l, a[i] + b[j]))); listsort 
(l, 1); l}
*/

static const uint64_t Pvalues[] = {
6ull, 12ull, 18ull, 30ull, 42ull, 54ull, 60ull, 66ull, 90ull, 120ull, 
126ull, 138ull, 150ull, 174ull, 198ull, 210ull, 240ull, 270ull, 294ull, 
330ull, 378ull, 420ull, 462ull, 510ull, 588ull, 630ull, 660ull, 690ull, 
750ull, 810ull, 840ull, 870ull, 966ull, 1020ull, 1050ull, 1260ull, 1320ull, 
1380ull, 1386ull, 1410ull, 1470ull, 1590ull, 1650ull, 1680ull, 1740ull,
1770ull, 1890ull, 2040ull, 2070ull, 2310ull, 2640ull, 2730ull, 2760ull, 
2940ull, 3150ull, 3300ull, 3570ull, 3630ull, 3990ull, 4080ull, 4410ull, 
4620ull, 4830ull, 5070ull, 5250ull, 5460ull, 5610ull, 5670ull, 6090ull, 
6600ull, 6930ull, 7140ull, 7350ull, 7590ull, 8190ull, 8250ull, 9030ull, 
9240ull, 9450ull, 9570ull, 9660ull, 9870ull, 10290ull, 10920ull, 11130ull, 
11220ull, 11550ull, 11970ull, 12180ull, 12390ull, 13230ull, 13530ull, 13860ull, 
14280ull, 14490ull, 15180ull, 15750ull, 16170ull, 16380ull, 16590ull, 17430ull, 
18480ull, 19110ull, 19320ull, 19740ull, 20580ull, 20790ull, 21630ull, 21840ull, 
22050ull, 22260ull, 22440ull, 22470ull, 23100ull, 24570ull, 24780ull, 24990ull, 
25410ull, 26250ull, 27510ull, 27930ull, 28050ull, 28350ull, 28560ull, 28770ull, 
28980ull, 29610ull, 30030ull, 31290ull, 32340ull, 32760ull, 33810ull, 34650ull, 
34860ull, 35070ull, 35490ull, 35910ull, 37170ull, 38220ull, 38640ull, 39270ull, 
39480ull, 42630ull, 43470ull, 43890ull, 44520ull, 46200ull, 46410ull, 48510ull, 
49350ull, 49980ull, 51870ull, 53130ull, 57330ull, 57750ull, 60060ull, 60690ull, 
62370ull, 62790ull, 66990ull, 67620ull, 67830ull, 70980ull, 71610ull, 73710ull, 
75810ull, 76230ull, 78540ull, 79170ull, 80850ull, 82110ull, 83790ull, 90090ull, 
91770ull, 92820ull, 94710ull, 99330ull, 103530ull, 103740ull, 103950ull, 
106260ull, 106470ull, 107730ull, 108570ull, 113190ull, 115500ull, 117390ull, 
120120ull, 121380ull, 122430ull, 125580ull, 127050ull, 128310ull, 131670ull, 
133770ull, 133980ull, 136290ull, 139230ull, 140070ull, 144690ull, 145530ull, 
150150ull, 155610ull, 157080ull, 158340ull, 159390ull, 161070ull, 164010ull, 
164220ull, 167790ull, 171990ull, 173250ull, 177870ull, 180180ull, 182490ull, 
185640ull, 187530ull, 188370ull, 189210ull, 191730ull, 196350ull, 207060ull, 
207480ull, 210210ull, 210630ull, 212520ull, 215670ull, 217140ull, 219450ull, 
226380ull, 226590ull, 228690ull, 233310ull, 237510ull, 237930ull, 240240ull, 
242550ull, 244860ull, 247170ull, 248430ull, 251160ull, 256620ull, 265650ull, 
267540ull, 270270ull, 272580ull, 274890ull, 275310ull, 278460ull, 279510ull, 
281190ull, 288750ull, 289380ull, 292110ull, 300300ull, 302610ull, 307230ull, 
311220ull, 311850ull, 314160ull, 316470ull, 322140ull, 324870ull, 325710ull, 
328440ull, 330330ull, 334950ull, 339570ull, 344190ull, 358050ull, 360360ull, 
363090ull, 371280ull, 371910ull, 376740ull, 381150ull, 383460ull, 384930ull, 
385770ull, 390390ull, 392700ull, 395010ull, 399630ull, 404250ull, 408870ull, 
413490ull, 414120ull, 417690ull, 420420ull, 431970ull, 434070ull, 434280ull, 
436590ull, 439530ull, 441210ull, 450450ull, 466830ull, 468930ull, 473550ull, 
475020ull, 475860ull, 482790ull, 483210ull, 489720ull, 494340ull, 501270ull, 
502320ull, 510510ull, 513240ull, 515130ull, 524370ull, 528990ull, 531300ull, 
542850ull, 545160ull, 547470ull, 549780ull, 554190ull, 556920ull, 565110ull, 
570570ull, 574770ull, 575190ull, 584430ull, 600600ull, 603330ull, 612150ull, 
622440ull, 630630ull, 649740ull, 651420ull, 658350ull, 667590ull, 669900ull, 
674310ull, 681450ull, 690690ull, 695310ull, 726180ull, 743820ull, 746130ull, 
750750ull, 753480ull, 759990ull, 780780ull, 785400ull, 788970ull, 796950ull, 
810810ull, 816270ull, 817740ull, 833910ull, 857010ull, 868560ull, 870870ull, 
879060ull, 881790ull, 903210ull, 921690ull, 930930ull, 933660ull, 937860ull, 
974610ull, 981750ull, 985530ull, 1009470ull, 1021020ull, 1051050ull, 
1062600ull, 1067430ull, 1089270ull, 1097250ull, 1113840ull, 1115730ull, 
1138830ull, 1141140ull, 1168860ull, 1171170ull, 1185030ull, 1193010ull, 
1206660ull, 1231230ull, 1253070ull, 1291290ull, 1328250ull, 1335180ull, 
1345890ull, 1348620ull, 1360590ull, 1374450ull, 1381380ull, 1400490ull, 
1411410ull, 1448370ull, 1471470ull, 1501500ull, 1504230ull, 1531530ull, 
1536150ull, 1540770ull, 1560090ull, 1577940ull, 1591590ull, 1610070ull, 
1651650ull, 1667820ull, 1711710ull, 1741740ull, 1753290ull, 1763580ull, 
1771770ull, 1806420ull, 1809990ull, 1820910ull, 1845690ull, 1859550ull, 
1861860ull, 1891890ull, 1919190ull, 1924230ull, 1951950ull, 1963500ull, 
1975050ull, 1995630ull, 2002770ull, 2042040ull, 2062830ull, 2072070ull, 
2081310ull, 2132130ull, 2134860ull, 2150610ull, 2178330ull, 2181270ull, 
2230410ull, 2252250ull, 2274090ull, 2277660ull, 2282280ull, 2312310ull, 
2316930ull, 2366910ull, 2370060ull, 2372370ull, 2386020ull, 2413950ull, 
2437890ull, 2459730ull, 2492490ull, 2497110ull, 2501730ull, 2552550ull, 
2589510ull, 2612610ull, 2645370ull, 2670360ull, 2691780ull, 2699970ull, 
2732730ull, 2738190ull, 2749110ull, 2762760ull, 2765070ull, 2788170ull, 
2815890ull, 2822820ull, 2852850ull, 2942940ull, 3008460ull, 3028410ull, 
3033030ull, 3060330ull, 3063060ull, 3081540ull, 3093090ull, 3134670ull, 
3148530ull, 3153150ull, 3183180ull, 3202290ull, 3213210ull, 3220140ull, 
3259410ull, 3291750ull, 3335640ull, 3337950ull, 3365670ull, 3379530ull, 
3423420ull, 3453450ull, 3513510ull, 3527160ull, 3543540ull, 3573570ull, 
3579030ull, 3612840ull, 3633630ull, 3641820ull, 3642870ull, 3666390ull, 
3691380ull, 3730650ull, 3753750ull, 3772230ull, 3838380ull, 3848460ull, 
3852030ull, 3933930ull, 3966270ull, 3993990ull, 4037670ull, 4081770ull, 
4084080ull, 4114110ull, 4144140ull, 4162620ull, 4201890ull, 4234230ull, 
4269720ull, 4294290ull, 4354350ull, 4362540ull, 4414410ull, 4474470ull, 
4512690ull, 4516050ull, 4520670ull, 4555320ull, 4594590ull, 4633860ull, 
4654650ull, 4696230ull, 4772040ull, 4774770ull, 4834830ull, 4919460ull, 
4984980ull, 4994220ull, 5015010ull, 5047350ull, 5075070ull, 5105100ull, 
5135130ull, 5144370ull, 5195190ull, 5225220ull, 5255250ull, 5290740ull, 
5315310ull, 5375370ull, 5379990ull, 5383560ull, 5465460ull, 5615610ull, 
5645640ull, 5675670ull, 5694150ull, 5705700ull, 5735730ull, 5851230ull, 
5855850ull, 6096090ull, 6126120ull, 6156150ull, 6172530ull, 6186180ull, 
6188490ull, 6276270ull, 6322470ull, 6404580ull, 6426420ull, 6440280ull, 
6516510ull, 6518820ull, 6636630ull, 6696690ull, 6802950ull, 6816810ull, 
6846840ull, 6876870ull, 6906900ull, 7054320ull, 7057050ull, 7066290ull, 
7087080ull, 7147140ull, 7158060ull, 7177170ull, 7225680ull, 7357350ull, 
7382760ull, 7417410ull, 7472010ull, 7477470ull, 7537530ull, 7597590ull, 
7657650ull, 7703850ull, 7936110ull, 7957950ull, 7971810ull, 7987980ull, 
8050350ull, 8075340ull, 8198190ull, 8258250ull, 8288280ull, 8325240ull, 
8351070ull, 8468460ull, 8539440ull, 8558550ull, 8678670ull, 8708700ull, 
8858850ull, 8948940ull, 8978970ull, 9032100ull, 9039030ull, 9085230ull, 
9110640ull, 9228450ull, 9279270ull, 9309300ull, 9421230ull, 9524130ull, 
9549540ull, 9606870ull, 9639630ull, 9669660ull, 9699690ull, 9759750ull, 
9879870ull, 9935310ull, 9969960ull, 10030020ull, 10150140ull, 10210200ull, 
10270260ull, 10360350ull, 10390380ull, 10581480ull, 10630620ull, 10660650ull, 
10720710ull, 10737090ull, 10750740ull, 10840830ull, 11104170ull, 11291280ull, 
11321310ull, 11388300ull, 11411400ull, 11463270ull, 11471460ull, 11741730ull, 
11981970ull, 12102090ull, 12192180ull, 12245310ull, 12252240ull, 12345060ull, 
12402390ull, 12462450ull, 12644940ull, 12684210ull, 12702690ull, 12762750ull, 
12809160ull, 12852840ull, 12880560ull, 13063050ull, 13123110ull, 13273260ull, 
13423410ull, 13783770ull, 13813800ull, 13876590ull, 14114100ull, 14174160ull, 
14176470ull, 14264250ull, 14504490ull, 14804790ull, 14834820ull, 14924910ull, 
14944020ull, 14954940ull, 14990430ull, 15142050ull, 15165150ull, 15195180ull, 
15354570ull, 15405390ull, 15465450ull, 15525510ull, 15825810ull, 15872220ull, 
15943620ull, 15945930ull, 16005990ull, 16546530ull, 16754010ull, 16786770ull, 
16936920ull, 17160990ull, 17267250ull, 17357340ull, 17447430ull, 17687670ull, 
17717700ull, 17867850ull, 17957940ull, 18064200ull, 18288270ull, 18348330ull, 
18517590ull, 18653250ull, 18828810ull, 19179930ull, 19360110ull, 19399380ull, 
19489470ull, 19759740ull, 19870620ull, 19909890ull, 19969950ull, 20030010ull, 
20281170ull, 20690670ull, 20930910ull, 21111090ull, 21162960ull, 21171150ull, 
21198870ull, 21261240ull, 21411390ull, 21681660ull, 21771750ull, 21951930ull, 
22252230ull, 22580250ull, 22642620ull, 22792770ull, 22926540ull, 23273250ull, 
23393370ull, 23483460ull, 23808330ull, 23993970ull, 24174150ull, 24204180ull, 
24534510ull, 25014990ull, 25525500ull, 25571910ull, 25675650ull, 26036010ull, 
26193090ull, 26246220ull, 26816790ull, 26936910ull, 26996970ull, 27057030ull, 
27957930ull, 28318290ull, 28352940ull, 28528500ull, 29099070ull, 29609580ull, 
29699670ull, 30120090ull, 30240210ull, 30390360ull, 30480450ull, 30709140ull, 
30780750ull, 30810780ull, 30955470ull, 31381350ull, 31612350ull, 31651620ull, 
32462430ull, 32522490ull, 32582550ull, 32626230ull, 33093060ull, 33183150ull, 
33663630ull, 33843810ull, 33963930ull, 34534500ull, 34597290ull, 34714680ull, 
35068110ull, 35225190ull, 35375340ull, 35945910ull, 36246210ull, 36606570ull, 
37031610ull, 37087050ull, 37447410ull, 37916970ull, 37987950ull, 38052630ull, 
38288250ull, 38798760ull, 39369330ull, 40060020ull, 40330290ull, 40510470ull, 
40562340ull, 40750710ull, 40930890ull, 41444130ull, 41861820ull, 42222180ull, 
42372330ull, 42450870ull, 42672630ull, 42792750ull, 42822780ull, 43363320ull, 
43393350ull, 43543500ull, 43753710ull, 43933890ull, 44021670ull, 44141370ull, 
44414370ull, 44894850ull, 45075030ull, 45615570ull, 45899490ull, 46276230ull, 
46456410ull, 46546500ull, 46692030ull, 46734870ull, 46966920ull, 47357310ull, 
47445090ull, 47870130ull, 47987940ull, 48498450ull, 49038990ull, 49339290ull, 
49519470ull, 49639590ull, 50029980ull, 51143820ull, 51381330ull, 51561510ull, 
51801750ull, 51921870ull, 52025610ull, 52386180ull, 52492440ull, 52582530ull, 
53063010ull, 53183130ull, 53289390ull, 53525010ull, 53633580ull, 53993940ull, 
54114060ull, 54204150ull, 54564510ull, 54624570ull, 54924870ull, 55915860ull, 
56486430ull, 57327270ull, 57627570ull, 57867810ull, 58198140ull, 58708650ull, 
58768710ull, 59219160ull, 59909850ull, 60090030ull, 60240180ull, 60480420ull, 
60690630ull, 60750690ull, 60843510ull, 61050990ull, 61771710ull, 61831770ull, 
61910940ull, 61928790ull, 62852790ull, 63303240ull, 63333270ull, 63813750ull, 
64127910ull, 64924860ull, 65044980ull, 65252460ull, 65615550ull, 66096030ull, 
66756690ull, 66876810ull, 67327260ull, 67687620ull, 67897830ull, 68798730ull, 
69038970ull, 69759690ull, 69939870ull, 70450380ull, 70750680ull, 71141070ull, 
71321250ull, 71981910ull, 72282210ull, 72522450ull, 72642570ull, 73213140ull, 
73603530ull, 73903830ull, 74023950ull, 74063220ull, 74744670ull, 75044970ull, 
75885810ull, 75975900ull, 76065990ull, 76715730ull, 77026950ull, 77267190ull, 
77597520ull, 78168090ull, 78738660ull, 79129050ull, 79835910ull, 80450370ull, 
81124680ull, 81171090ull, 81501420ull, 81591510ull, 81861780ull, 82192110ull, 
82732650ull, 83573490ull, 83723640ull, 83873790ull, 84744660ull, 84901740ull, 
85014930ull, 85255170ull, 85804950ull, 86276190ull, 86336250ull, 86726640ull, 
86786700ull, 87297210ull, 87507420ull, 88318230ull, 88438350ull, 88828740ull, 
89339250ull, 89699610ull, 90360270ull, 90480390ull, 90720630ull, 91381290ull, 
91861770ull, 92552460ull, 92912820ull, 93002910ull, 93933840ull, 94144050ull, 
94714620ull, 95285190ull, 95465370ull, 95975880ull, 96426330ull, 96996900ull, 
97387290ull, 97507410ull, 97567470ull, 97878690ull, 98708610ull, 99038940ull, 
99279180ull, 99549450ull, 99849750ull, 100150050ull, 100990890ull, 
102132030ull, 102287640ull, 102762660ull, 102912810ull, 103633530ull, 
103843740ull, 104654550ull, 104772360ull, 105165060ull, 106126020ull, 
106696590ull, 107056950ull, 107267160ull, 107837730ull, 108228120ull, 
108978870ull, 109249140ull, 109819710ull, 109849740ull, 110780670ull, 
111261150ull, 112822710ull, 113843730ull, 114654540ull, 115345230ull, 
115825710ull, 115885770ull, 116396280ull, 116906790ull, 116966850ull, 
117417300ull, 117537420ull, 118107990ull, 118438320ull, 119249130ull, 
119489370ull, 119969850ull, 120180060ull, 120480360ull, 121687020ull, 
122011890ull, 122101980ull, 122252130ull, 122792670ull, 123813690ull, 
125074950ull, 126095970ull, 126606480ull, 126666540ull, 127116990ull, 
127237110ull, 128138010ull, 128378250ull, 129159030ull, 129519390ull, 
129849720ull, 130180050ull, 130660530ull, 130965450ull, 131231100ull, 
131801670ull, 134083950ull, 134654520ull, 134984850ull, 135225090ull, 
135285150ull, 135795660ull, 136366230ull, 139369230ull, 139789650ull, 
139879740ull, 140210070ull, 140900760ull, 140930790ull, 141591450ull, 
141968190ull, 142071930ull, 142282140ull, 143213070ull, 143963820ull, 
144354210ull, 145495350ull, 147537390ull, 147807660ull, 148047900ull, 
148918770ull, 149879730ull, 150600450ull, 151110960ull, 151201050ull, 
151771620ull, 152131980ull, 152642490ull, 153431460ull, 153663510ull, 
157477320ull, 158258100ull, 159189030ull, 160900740ull, 162249360ull, 
162312150ull, 162342180ull, 163002840ull, 163873710ull, 164384220ull, 
164894730ull, 165465300ull, 165915750ull, 167447280ull, 167957790ull, 
168318150ull, 169489320ull, 170029860ull, 170510340ull, 170600430ull, 
171741570ull, 171981810ull, 172552380ull, 173573400ull, 174594420ull, 
175104930ull, 176125950ull, 176306130ull, 176636460ull, 176876700ull, 
177657480ull, 180720540ull, 181231050ull, 181441260ull, 181741560ull, 
182252070ull, 182530530ull, 182762580ull, 183032850ull, 183152970ull, 
183351630ull, 183723540ull, 184294110ull, 187717530ull, 188770890ull, 
188978790ull, 189429240ull, 189999810ull, 190570380ull, 191441250ull, 
191951760ull, 192462270ull, 193993800ull, 194774580ull, 195014820ull, 
196846650ull, 197417220ull, 198077880ull, 199609410ull, 200300100ull, 
201981780ull, 202552350ull, 203693490ull, 203753550ull, 204264060ull, 
205735530ull, 207267060ull, 207897690ull, 209309100ull, 209544720ull, 
210330120ull, 210840630ull, 211861650ull, 212252040ull, 214113900ull, 
215104890ull, 215945730ull, 216456240ull, 216966750ull, 218498280ull, 
219639420ull, 220330110ull, 220810590ull, 222071850ull, 223092870ull, 
227237010ull, 228197970ull, 229939710ull, 230750520ull, 231651420ull, 
231771540ull, 232792560ull, 233813580ull, 234834600ull, 235074840ull, 
235525290ull, 235645410ull, 236215980ull, 236786550ull, 239939700ull, 
240960720ull, 241351110ull, 242492250ull, 243374040ull, 244203960ull, 
246576330ull, 248197950ull, 249339090ull, 251170920ull, 251681430ull, 
252191940ull, 253723470ull, 254233980ull, 255765510ull, 257807550ull, 
258318060ull, 260390130ull, 261891630ull, 262462200ull, 263655210ull, 
263933670ull, 264954690ull, 265315050ull, 268167900ull, 269038770ull, 
269969700ull, 271080810ull, 272101830ull, 273122850ull, 274143870ull, 
274444170ull, 275585310ull, 278348070ull, 279759480ull, 280420140ull, 
281291010ull, 281801520ull, 283573290ull, 284143860ull, 285375090ull, 
287927640ull, 288708420ull, 291736830ull, 292522230ull, 293543250ull, 
294984690ull, 296095800ull, 296606310ull, 297837540ull, 298137840ull, 
300450150ull, 300690390ull, 301200900ull, 302972670ull, 304113810ull, 
304263960ull, 305284980ull, 310900590ull, 311501190ull, 311921610ull, 
314384070ull, 316516200ull, 318378060ull, 318948630ull, 320089770ull, 
321801480ull, 324684360ull, 326058810ull, 326696370ull, 327747420ull, 
328077750ull, 329789460ull, 331320990ull, 334384050ull, 335915580ull, 
336065730ull, 336636300ull, 338978640ull, 339489150ull, 340510170ull, 
341200860ull, 347477130ull, 348618270ull, 351741390ull, 353753400ull, 
354323970ull, 355314960ull, 355825470ull, 358888530ull, 359909550ull, 
361441080ull, 363483120ull, 363993630ull, 368588220ull, 370119750ull, 
370299930ull, 371441070ull, 373182810ull, 375435060ull, 378287910ull, 
379999620ull, 380570190ull, 381350970ull, 384924540ull, 387477090ull, 
391561170ull, 393122730ull, 395645250ull, 396155760ull, 397687290ull, 
399218820ull, 401110710ull, 402251850ull, 403963560ull, 406816410ull, 
407897490ull, 410960550ull, 411471060ull, 413663250ull, 414534120ull, 
417086670ull, 418618200ull, 420630210ull, 421681260ull, 423723300ull, 
429024750ull, 430209780ull, 433062630ull, 436486050ull, 440660220ull, 
442191750ull, 444474030ull, 446185740ull, 446756310ull, 451801350ull, 
453332880ull, 455885430ull, 457927470ull, 458948490ull, 459308850ull, 
459879420ull, 459969510ull, 466155690ull, 471050580ull, 471200730ull, 
475284810ull, 477567090ull, 479879400ull, 481410930ull, 482702220ull, 
484984500ull, 485555070ull, 494684190ull, 498678180ull, 500750250ull, 
502341840ull, 503362860ull, 503873370ull, 504894390ull, 509519010ull, 
511801290ull, 512041530ull, 512942430ull, 514083570ull, 515224710ull, 
516636120ull, 518167650ull, 520780260ull, 523272750ull, 523783260ull, 
530630100ull, 535284750ull, 538047510ull, 538077540ull, 544203660ull, 
548888340ull, 551861310ull, 552882330ull, 553903350ull, 556696140ull, 
562582020ull, 564293730ull, 569999430ull, 572281710ull, 575344770ull, 
575855280ull, 577386810ull, 577416840ull, 579128550ull, 584834250ull, 
587086500ull, 588153930ull, 590539950ull, 598828230ull, 599849250ull, 
601380780ull, 606996390ull, 612221610ull, 616786170ull, 619068450ull, 
620930310ull, 622311690ull, 623843220ull, 628768140ull, 630479850ull, 
636605970ull, 643032390ull, 645314670ull, 645795150ull, 647837190ull, 
648858210ull, 649368720ull, 652117620ull, 654443790ull, 656155500ull, 
659578920ull, 660990330ull, 669278610ull, 672131460ull, 676425750ull, 
681020340ull, 688677990ull, 689819130ull, 692762070ull, 695524830ull, 
695825130ull, 708647940ull, 711500790ull, 711650940ull, 717777060ull, 
721771050ull, 725434710ull, 727476750ull, 727987260ull, 737176440ull, 
740239500ull, 743813070ull, 748017270ull, 750403290ull, 755044290ull, 
760569810ull, 761140380ull, 763212450ull, 766275510ull, 774263490ull, 
775464690ull, 777686910ull, 784653870ull, 786695910ull, 791290500ull, 
795374580ull, 795945150ull, 798437640ull, 805074270ull, 806566530ull, 
810779970ull, 813632820ull, 824473650ull, 826755930ull, 827326500ull, 
829068240ull, 831320490ull, 833662830ull, 837236400ull, 838767930ull, 
843873030ull, 853002150ull, 861290430ull, 866695830ull, 872090310ull, 
873482610ull, 879248370ull, 880629750ull, 882671790ull, 884383500ull, 
892371480ull, 902071170ull, 904113210ull, 907776870ull, 911770860ull, 
917896980ull, 921470550ull, 927596670ull, 931740810ull, 933722790ull, 
937446510ull, 940869930ull, 941410470ull, 943152210ull, 950569620ull, 
953214990ull, 955134180ull, 962311350ull, 962821860ull, 971110140ull, 
974563590ull, 976245270ull, 979668690ull, 983752770ull, 984233250ull, 
992221230ull, 997356360ull, 998047050ull, 999068070ull, 1006335330ull, 
1006725720ull, 1008197190ull, 1010479470ull, 1012498410ull, 1021530510ull, 
1025884860ull, 1028167140ull, 1028677650ull, 1031740710ull, 1036725690ull, 
1037866830ull, 1042431390ull, 1043572530ull, 1045013970ull, 1051140090ull, 
1068497430ull, 1075524450ull, 1076155080ull, 1076665590ull, 1078947870ull, 
1089218130ull, 1099488390ull, 1103722620ull, 1105764660ull, 1109338230ull, 
1115464350ull, 1123632510ull, 1125164040ull, 1134803670ull, 1134863730ull, 
1138947810ull, 1141710570ull, 1144563420ull, 1150689540ull, 1153121970ull, 
1154263110ull, 1169578410ull, 1173662490ull, 1174803630ull, 1176307860ull, 
1181770590ull, 1185914730ull, 1194203010ull, 1202761560ull, 1209398190ull, 
1212461250ull, 1213992780ull, 1220449230ull, 1228797570ull, 1233572340ull, 
1234923690ull, 1241860620ull, 1244623380ull, 1245554310ull, 1246695450ull, 
1251260010ull, 1255824570ull, 1256365110ull, 1258407150ull, 1263272010ull, 
1270659390ull, 1271680410ull, 1273211940ull, 1286064780ull, 1290058770ull, 
1291590300ull, 1295163870ull, 1297716420ull, 1299187890ull, 1307175870ull, 
1309458150ull, 1313542230ull, 1325434110ull, 1328857530ull, 1330959630ull, 
1338557220ull, 1342010670ull, 1345193850ull, 1347235890ull, 1351680330ull, 
1362040680ull, 1367656290ull, 1373361990ull, 1377926550ull, 1380208830ull, 
1385524140ull, 1391049660ull, 1391650260ull, 1397265870ull, 1397325930ull, 
1404172770ull, 1406455050ull, 1415644230ull, 1420749330ull, 1421289870ull, 
1422130710ull, 1425854430ull, 1435554120ull, 1436064630ull, 1440148710ull, 
1443542100ull, 1445253810ull, 1447536090ull, 1450869420ull, 1455974520ull, 
1456665210ull, 1467716250ull, 1468076610ull, 1474352880ull, 1484052570ull, 
1487626140ull, 1495283790ull, 1496034540ull, 1503451950ull, 1524893370ull, 
1535403870ull, 1538166630ull, 1538827290ull, 1542250710ull, 1548526980ull, 
1555373820ull, 1558587030ull, 1561650090ull, 1569307740ull, 1573391820ull, 
1581049470ull, 1584112530ull, 1587896310ull, 1590749160ull, 1596364770ull, 
1598406810ull, 1608617010ull, 1610148540ull, 1619848230ull, 1627265640ull, 
1639247610ull, 1640388750ull, 1648947300ull, 1655583930ull, 1658646990ull, 
1662640980ull, 1667776110ull, 1672941270ull, 1677535860ull, 1678046370ull, 
1679067390ull, 1687746060ull, 1692881190ull, 1693361670ull, 1697445750ull, 
1702550850ull, 1703571870ull, 1704292590ull, 1716845130ull, 1719127410ull, 
1726034310ull, 1736244510ull, 1737265530ull, 1745373630ull, 1746965220ull, 
1749517770ull, 1758496740ull, 1761770010ull, 1764461790ull, 1765343580ull, 
1770478710ull, 1771619850ull, 1784742960ull, 1786454670ull, 1804142340ull, 
1808226420ull, 1813842030ull, 1819968150ull, 1821830010ull, 1822010190ull, 
1823541720ull, 1835793960ull, 1836664830ull, 1850358510ull, 1850598750ull, 
1852640790ull, 1866935070ull, 1867445580ull, 1876604730ull, 1881739860ull, 
1882820940ull, 1891439550ull, 1892580690ull, 1902850950ull, 1925643720ull, 
1929097170ull, 1937385450ull, 1939427490ull, 1949127180ull, 1952490540ull, 
1955343390ull, 1960868910ull, 1963331370ull, 1967505540ull, 1969037070ull, 
1984352370ull, 1984442460ull, 1988436450ull, 1996094100ull, 1998136140ull, 
2007835830ull, 2012670660ull, 2020958940ull, 2027235210ull, 2028256230ull, 
2031319290ull, 2034082050ull, 2043061020ull, 2054802750ull, 2056334280ull, 
2073181110ull, 2075733660ull, 2078286210ull, 2086574490ull, 2087145060ull, 
2087475390ull, 2090027940ull, 2101769670ull, 2102280180ull, 2104832730ull, 
2134502370ull, 2136994860ull, 2139066930ull, 2143631490ull, 2153331180ull, 
2163030870ull, 2165313150ull, 2168135970ull, 2178436260ull, 2182430250ull, 
2191559370ull, 2195703510ull, 2201829630ull, 2205913710ull, 2207445240ull, 
2217805590ull, 2218676460ull, 2221229010ull, 2230928700ull, 2242670430ull, 
2244051810ull, 2250328080ull, 2270298030ull, 2277895620ull, 2279427150ull, 
2281709430ull, 2283421140ull, 2289126840ull, 2289637350ull, 2294742450ull, 
2298826530ull, 2318225910ull, 2322790470ull, 2333060730ull, 2349036690ull, 
2353961610ull, 2358045690ull, 2376424050ull, 2383571190ull, 2395823430ull, 
2405523120ull, 2407054650ull, 2415222810ull, 2418796380ull, 2427985560ull, 
2434622190ull, 2440898460ull, 2454021570ull, 2457595140ull, 2467144680ull, 
2469847380ull, 2472399930ull, 2473420950ull, 2489246760ull, 2493961470ull, 
2506514010ull, 2512730220ull, 2531619090ull, 2543360820ull, 2546423880ull, 
2547955410ull, 2561228670ull, 2564712150ull, 2570417850ull, 2580117540ull, 
2583180600ull, 2594922330ull, 2595432840ull, 2618405790ull, 2620447830ull, 
2627084460ull, 2637745110ull, 2648015370ull, 2650057410ull, 2657715060ull, 
2663991330ull, 2665372710ull, 2677114440ull, 2688856170ull, 2690237550ull, 
2703360660ull, 2706213510ull, 2712339630ull, 2723330610ull, 2724081360ull, 
2735312580ull, 2759306550ull, 2764411650ull, 2771048280ull, 2783300520ull, 
2803210410ull, 2806273470ull, 2808345540ull, 2812339530ull, 2812910100ull, 
2841498660ull, 2847714870ull, 2861408550ull, 2871108240ull, 2872129260ull, 
2876723850ull, 2890507620ull, 2900207310ull, 2911949040ull, 2913330420ull, 
2919606690ull, 2923690770ull, 2926453530ull, 2928735810ull, 2947174230ull, 
2975252280ull, 2976663690ull, 2978945970ull, 2994141150ull, 2997204210ull, 
3005192190ull, 3006903900ull, 3034981950ull, 3049786740ull, 3077654580ull, 
3083930850ull, 3084501420ull, 3097053960ull, 3104651550ull, 3110177070ull, 
3111558450ull, 3113600490ull, 3123300180ull, 3130717590ull, 3132999870ull, 
3138615480ull, 3146783640ull, 3152399250ull, 3168225060ull, 3181498320ull, 
3191198010ull, 3205492290ull, 3212639430ull, 3217234020ull, 3220297080ull, 
3228975750ull, 3229996770ull, 3239696460ull, 3244291050ull, 3267654390ull, 
3272218950ull, 3278495220ull, 3297894600ull, 3311167860ull, 3317293980ull, 
3325281960ull, 3326993670ull, 3345882540ull, 3346393050ull, 3355071720ull, 
3356092740ull, 3358134780ull, 3375492120ull, 3393359970ull, 3404591190ull, 
3405101700ull, 3425131710ull, 3433690260ull, 3443389950ull, 3462789330ull, 
3463810350ull, 3472489020ull, 3475552080ull, 3477624150ull, 3479125650ull, 
3493930440ull, 3499035540ull, 3501588090ull, 3520987470ull, 3534260730ull, 
3590597010ull, 3608284680ull, 3637383750ull, 3639936300ull, 3647083440ull, 
3656783130ull, 3661347690ull, 3671587920ull, 3686392710ull, 3700717020ull, 
3705281580ull, 3719065350ull, 3733870140ull, 3734891160ull, 3745611870ull, 
3753780030ull, 3763479720ull, 3769095330ull, 3792578790ull, 3802849050ull, 
3805701900ull, 3851287440ull, 3863029170ull, 3870176310ull, 3871317450ull, 
3888434550ull, 3898254360ull, 3908975070ull, 3921737820ull, 3923269350ull, 
3926662740ull, 3938074140ull, 3950056110ull, 3976872900ull, 3996272280ull, 
4003929930ull, 4005971970ull, 4015671660ull, 4025371350ull, 4055040990ull, 
4062638580ull, 4068164100ull, 4086122040ull, 4102968870ull, 4112668560ull, 
4122368250ull, 4151467320ull, 4156572420ull, 4156602450ull, 4168314150ull, 
4173148980ull, 4174950780ull, 4180055880ull, 4186272090ull, 4193839650ull, 
4203539340ull, 4212518310ull, 4219365150ull, 4238764530ull, 4248974730ull, 
4285551270ull, 4287262980ull, 4306662360ull, 4317503190ull, 4335761430ull, 
4346512170ull, 4356872520ull, 4367413050ull, 4369995630ull, 4384259880ull, 
4403659260ull, 4413358950ull, 4414890480ull, 4426632210ull, 4442458020ull, 
4452157710ull, 4456241790ull, 4461857400ull, 4474980510ull, 4485340860ull, 
4510355850ull, 4555791240ull, 4558854300ull, 4578253680ull, 4589484900ull, 
4607352750ull, 4616481870ull, 4645580940ull, 4658704050ull, 4665550890ull, 
4666121460ull, 4668613950ull, 4684950270ull, 4707923220ull, 4731917190ull, 
4743148410ull, 4767142380ull, 4772247480ull, 4781947170ull, 4791646860ull, 
4814109300ull, 4820745930ull, 4830445620ull, 4837592760ull, 4849334490ull, 
4855971120ull, 4859544690ull, 4870775910ull, 4872817950ull, 4881796920ull, 
4898343450ull, 4908043140ull, 4917742830ull, 4947412470ull, 4975940970ull, 
4978493520ull, 4980505530ull, 5014739730ull, 5025460440ull, 5034139110ull, 
5063238180ull, 5078643570ull, 5092847760ull, 5107652550ull, 5111736630ull, 
5129424300ull, 5150535390ull, 5169934770ull, 5189334150ull, 5190865680ull, 
5206691490ull, 5208733530ull, 5240895660ull, 5248553310ull, 5288613330ull, 
5295520230ull, 5307261960ull, 5315430120ull, 5327982660ull, 5341105770ull, 
5344529190ull, 5354228880ull, 5412427020ull, 5419844430ull, 5422126710ull, 
5441526090ull, 5470625160ull, 5492577090ull, 5509994490ull, 5518613100ull, 
5542096560ull, 5551075530ull, 5553838290ull, 5566601040ull, 5577321750ull, 
5606420820ull, 5625820200ull, 5635519890ull, 5664618960ull, 5674318650ull, 
5708552850ull, 5713117410ull, 5722817100ull, 5771315550ull, 5776931160ull, 
5781015240ull, 5788672890ull, 5800414620ull, 5835639810ull, 5847381540ull, 
5889994110ull, 5907111210ull, 5918522610ull, 5926510590ull, 5929573650ull, 
5950504560ull, 5966330370ull, 6013807800ull, 6023507490ull, 6069963900ull, 
6070474410ull, 6081705630ull, 6101105010ull, 6102246150ull, 6167861700ull, 
6169002840ull, 6178702530ull, 6187891710ull, 6207231030ull, 6227200980ull, 
6258342090ull, 6265999740ull, 6277230960ull, 6281825550ull, 6293567280ull, 
6295098810ull, 6312215910ull, 6314498190ull, 6353296950ull, 6382396020ull, 
6425278860ull, 6430894470ull, 6440594160ull, 6450293850ull, 6459993540ull, 
6469693230ull, 6479392920ull, 6488582100ull, 6489092610ull, 6547290750ull, 
6563627070ull, 6605488890ull, 6622335720ull, 6653987340ull, 6668251590ull, 
6683086410ull, 6712185480ull, 6750984240ull, 6760683930ull, 6784647870ull, 
6810203400ull, 6818882070ull, 6821945130ull, 6838281450ull, 6845428590ull, 
6850263420ull, 6867380520ull, 6896479590ull, 6906179280ull, 6915878970ull, 
6927620700ull, 6944978040ull, 6958251300ull, 6968371410ull, 6994617630ull, 
7032275250ull, 7090473390ull, 7150713570ull, 7174197030ull, 7181194020ull, 
7216569360ull, 7226269050ull, 7230833610ull, 7245668430ull, 7265067810ull, 
7279872600ull, 7283956680ull, 7313566260ull, 7322695380ull, 7335818490ull, 
7362064710ull, 7401434040ull, 7439662230ull, 7467740280ull, 7491223740ull, 
7517259750ull, 7526959440ull, 7556058510ull, 7585157580ull, 7594857270ull, 
7620382770ull, 7650773130ull, 7694136450ull, 7726058340ull, 7729511790ull, 
7750052310ull, 7796508720ull, 7802124330ull, 7808250450ull, 7817950140ull, 
7876148280ull, 7890953070ull, 7924646730ull, 7953745800ull, 7991973990ull, 
7992544560ull, 8007859860ull, 8011943940ull, 8018220210ull, 8050742700ull, 
8090051970ull, 8099241150ull, 8118640530ull, 8136328200ull, 8172244080ull, 
8183985810ull, 8205937740ull, 8254436190ull, 8275877610ull, 8277919650ull, 
8302934640ull, 8313144840ull, 8372544180ull, 8390231850ull, 8435156730ull, 
8477529060ull, 8497949460ull, 8512754250ull, 8543144610ull, 8583204630ull, 
8584225650ull, 8613324720ull, 8635006380ull, 8653655010ull, 8661823170ull, 
8671522860ull, 8681222550ull, 8700621930ull, 8720021310ull, 8739420690ull, 
8739991260ull, 8758820070ull, 8768519760ull, 8807318520ull, 8853264420ull, 
8855816970ull, 8884916040ull, 8912483580ull, 8949961020ull, 8952813870ull, 
8991612630ull, 9005906910ull, 9020711700ull, 9040111080ull, 9099840750ull, 
9117708600ull, 9146807670ull, 9170291130ull, 9178969800ull, 9225546330ull, 
9232963740ull, 9251792550ull, 9263203950ull, 9331101780ull, 9340801470ull, 
9381642270ull, 9463834380ull, 9514254750ull, 9534284760ull, 9544494960ull, 
9563894340ull, 9573594030ull, 9592993410ull, 9628218600ull, 9660891240ull, 
9689990310ull, 9698668980ull, 9719089380ull, 9728789070ull, 9745906170ull, 
9767587830ull, 9816086280ull, 9845185350ull, 9894824940ull, 9942182250ull, 
9961581630ull, 10039179150ull, 10068278220ull, 10116776670ull, 10170410250ull, 
10222902690ull, 10223473260ull, 10275395130ull, 10301070780ull, 10339869540ull, 
10378668300ull, 10391431050ull, 10407767370ull, 10426656240ull, 10465965510ull, 
10485364890ull, 10524163650ull, 10555815270ull, 10577226660ull, 10579298730ull, 
10591040460ull, 10630860240ull, 10682211540ull, 10689058380ull, 10721580870ull, 
10771791030ull, 10873352490ull, 10931550630ull, 10941250320ull, 10970349390ull, 
10984043070ull, 11037226200ull, 11125544430ull, 11154643500ull, 11236835610ull, 
11261340090ull, 11271039780ull, 11290439160ull, 11377736370ull, 11397135750ull, 
11416535130ull, 11426234820ull, 11445634200ull, 11473712250ull, 11532931410ull, 
11553862320ull, 11577345780ull, 11589087510ull, 11707525830ull, 11726925210ull, 
11797675890ull, 11823922110ull, 11853021180ull, 11917855950ull, 11932660740ull, 
12017915910ull, 12035273250ull, 12047014980ull, 12076114050ull, 12095513430ull, 
12140948820ull, 12202210020ull, 12204492300ull, 12270107850ull, 12308906610ull, 
12328305990ull, 12338005680ull, 12375783420ull, 12454401960ull, 12516684180ull, 
12558816270ull, 12624431820ull, 12716293590ull, 12739777050ull, 12850557720ull, 
12852089250ull, 12919987080ull, 12929686770ull, 12939386460ull, 13026683670ull, 
13084881810ull, 13109986890ull, 13162479330ull, 13172179020ull, 13220677470ull, 
13244671440ull, 13279896630ull, 13319956650ull, 13366172820ull, 13424941530ull, 
13521367860ull, 13531067550ull, 13637764140ull, 13686262590ull, 13734761040ull, 
13783259490ull, 13796532750ull, 13831757940ull, 13960916970ull, 13996652670ull, 
14064550500ull, 14081097030ull, 14132448330ull, 14238574350ull, 14307042750ull, 
14345841510ull, 14348394060ull, 14461667220ull, 14491336860ull, 14501036550ull, 
14559234690ull, 14641937310ull, 14714429730ull, 14733829110ull, 14842237410ull, 
14879324460ull, 14908423530ull, 14923738830ull, 14947222290ull, 14982447480ull, 
15034519500ull, 15044219190ull, 15052207170ull, 15112117020ull, 15170315160ull, 
15296411130ull, 15335209890ull, 15432206790ull, 15451606170ull, 15459023580ull, 
15500104620ull, 15604248660ull, 15752296560ull, 15839593770ull, 15865839990ull, 
15907491600ull, 15936590670ull, 15955990050ull, 16003977990ull, 16015719720ull, 
16033587570ull, 16063197150ull, 16101485400ull, 16237281060ull, 16266380130ull, 
16364518170ull, 16367971620ull, 16508872380ull, 16596169590ull, 16684998330ull, 
16731965250ull, 16867760910ull, 16955058120ull, 16993856880ull, 17025508500ull, 
17107700610ull, 17139352230ull, 17178150990ull, 17216949750ull, 17323646340ull, 
17366018670ull, 17440042620ull, 17478841380ull, 17493105630ull, 17546739210ull, 
17624336730ull, 17721333630ull, 17740733010ull, 17779531770ull, 17835687870ull, 
17886798930ull, 17899922040ull, 18047039010ull, 18199681500ull, 18283915650ull, 
18293615340ull, 18303315030ull, 18306738450ull, 18342113790ull, 18516708210ull, 
18647939310ull, 18691302630ull, 18728059350ull, 18816888090ull, 18885296430ull, 
18962893950ull, 18978869910ull, 19021092090ull, 19028509500ull, 19068569520ull, 
19120371270ull, 19127788680ull, 19256437200ull, 19291662390ull, 19379980620ull, 
19409079690ull, 19457578140ull, 19535175660ull, 19544875350ull, 19603073490ull, 
19855265430ull, 19884364500ull, 19934004090ull, 19971661710ull, 20019649650ull, 
20029859850ull, 20049259230ull, 20090100030ull, 20301451170ull, 20340820500ull, 
20437246830ull, 20446946520ull, 20456646210ull, 20514844350ull, 20747636910ull, 
20815534740ull, 20878868010ull, 20931360450ull, 20970729780ull, 21077426370ull, 
21111630540ull, 21174423270ull, 21193822650ull, 21271420170ull, 21349017690ull, 
21378116760ull, 21475624170ull, 21561269730ull, 21570579030ull, 21640008390ull, 
21692500830ull, 21746704980ull, 21863101260ull, 21968086140ull, 22056524490ull, 
22086194130ull, 22133161050ull, 22221989790ull, 22251088860ull, 22318986690ull, 
22338386070ull, 22374902550ull, 22453641210ull, 22532379870ull, 22551779250ull, 
22609977390ull, 22626313710ull, 22794271500ull, 22814181390ull, 22821088290ull, 
22852469640ull, 22978565610ull, 23065862820ull, 23154691560ull, 23250156930ull, 
23347153830ull, 23463550110ull, 23595351780ull, 23647844220ull, 23659585950ull, 
23730036330ull, 23754540810ull, 23773940190ull, 23870937090ull, 23909735850ull, 
23975921970ull, 24002168190ull, 24108294210ull, 24161927790ull, 24176222070ull, 
24191026860ull, 24324269970ull, 24404420040ull, 24540215700ull, 24608113530ull, 
24617813220ull, 24656611980ull, 24737062350ull, 24751566840ull, 24763308570ull, 
24815801010ull, 24957302370ull, 25288232970ull, 25432587180ull, 25498202730ull, 
25514779290ull, 25558683150ull, 25597481910ull, 25843547730ull, 25849673850ull, 
25878772920ull, 25985469510ull, 26100844770ull, 26101865790ull, 26160063930ull, 
26198862690ull, 26218262070ull, 26219283090ull, 26324958660ull, 26325529230ull, 
26441354940ull, 26521805310ull, 26548051530ull, 26722645950ull, 26732345640ull, 
26897240370ull, 26900303430ull, 26994237270ull, 27020483490ull, 27042735720ull, 
27062135100ull, 27077960910ull, 27256699470ull, 27275528280ull, 27285227970ull, 
27362825490ull, 27566518980ull, 27663515880ull, 27886608750ull, 27921833940ull, 
28027509510ull, 28141082970ull, 28262344110ull, 28264896660ull, 28352193870ull, 
28403244870ull, 28410392010ull, 28528830330ull, 28565587050ull, 28647749130ull, 
28774415670ull, 28778980230ull, 28883965110ull, 28943364450ull, 28972974030ull, 
29225165970ull, 29248649430ull, 29283874620ull, 29428859460ull, 29613153570ull, 
29632552950ull, 29671351710ull, 29787747990ull, 29788769010ull, 29816847060ull, 
29847477660ull, 29894444580ull, 29920480590ull, 30065045010ull, 30098138070ull, 
30117537450ull, 30211471290ull, 30224234040ull, 30263603370ull, 30305405130ull, 
30330930630ull, 30369729390ull, 30496335870ull, 30563723190ull, 30758858130ull, 
30939458550ull, 30971110170ull, 30986425470ull, 31000209240ull, 31223302110ull, 
31456094670ull, 31572490950ull, 31587325770ull, 31744803090ull, 31785884130ull, 
31873181340ull, 31902280410ull, 32007955980ull, 32067175140ull, 32138496390ull, 
32170808670ull, 32173871730ull, 32348466150ull, 32367865530ull, 32395433070ull, 
32532189690ull, 32559817290ull, 32585342790ull, 32689667010ull, 32794651890ull, 
32949846930ull, 33008045070ull, 33017744760ull, 33029486490ull, 33123420330ull, 
33192339180ull, 33240837630ull, 33293330070ull, 33369996660ull, 33376633290ull, 
33473630190ull, 33735521820ull, 33740116410ull, 33765762030ull, 33803419650ull, 
33910116240ull, 34133209110ull, 34215401220ull, 34278704460ull, 34356301980ull, 
34389485130ull, 34391527170ull, 34579394850ull, 34618193610ull, 34812187410ull, 
34880085240ull, 35072547510ull, 35161376250ull, 35180775630ull, 35393027670ull, 
35471766330ull, 35481466020ull, 35773597860ull, 35782156410ull, 35812787010ull, 
35847501690ull, 36014948970ull, 36094078020ull, 36286540290ull, 36364137810ull, 
36434588190ull, 36587230680ull, 36716389710ull, 36763356630ull, 36810323550ull, 
36849122310ull, 36965518590ull, 36974707770ull, 36984917970ull, 37033416420ull, 
37256509290ull, 37382605260ull, 37411704330ull, 37456118700ull, 37586298750ull, 
37633776180ull, 37702695030ull, 37780292550ull, 37838490690ull, 37925787900ull, 
37954886970ull, 38042184180ull, 38092724670ull, 38148880770ull, 38240742540ull, 
38358850530ull, 38401072710ull, 38477649210ull, 38536868370ull, 38575667130ull, 
38583324780ull, 38595066510ull, 38789060310ull, 38818159380ull, 38947318410ull, 
39041252250ull, 39118849770ull, 39182153010ull, 39198729570ull, 39390441090ull, 
39487437990ull, 39662032410ull, 39710530860ull, 39933623730ull, 39943323420ull, 
39957107190ull, 39991821870ull, 40166416290ull, 40180200060ull, 40520710230ull, 
40593202650ull, 40602902340ull, 40612602030ull, 40632001410ull, 40721010330ull, 
40913292420ull, 41088457410ull, 41194583430ull, 41201730570ull, 41349778470ull, 
41495273820ull, 41631069480ull, 41694883230ull, 41718366690ull, 41902090230ull, 
41906234370ull, 41912360490ull, 41941459560ull, 41989958010ull, 42154852740ull, 
42223261080ull, 42243291090ull, 42348846540ull, 42397344990ull, 42552540030ull, 
42563771250ull, 42610738170ull, 42668936310ull, 42756233520ull, 42845572770ull, 
42951248340ull, 43037524530ull, 43141158060ull, 43280016780ull, 43503109650ull, 
43529355870ull, 43600106550ull, 44201487330ull, 44220886710ull, 44502177720ull, 
44606832270ull, 44628273690ull, 44725270590ull, 44802868110ull, 44841666870ull, 
44907282420ull, 45156621510ull, 45210255090ull, 45252627420ull, 45287852610ull, 
45404248890ull, 45628362780ull, 45642176580ull, 45704939280ull, 45734038350ull, 
45957131220ull, 46005629670ull, 46044428430ull, 46131725640ull, 46296620370ull, 
46626409830ull, 46649893290ull, 46694307660ull, 46927100220ull, 46956199290ull, 
46975598670ull, 47295688440ull, 47499381930ull, 47538180690ull, 47683165530ull, 
47741874180ull, 47809772010ull, 47819471700ull, 48004336380ull, 48011933970ull, 
48100762710ull, 48216588420ull, 48323855580ull, 48352444140ull, 48382053720ull, 
48411152790ull, 48648539940ull, 48663344730ull, 48779741010ull, 49012533570ull, 
49080431400ull, 49093554510ull, 49167728610ull, 49225926750ull, 49303524270ull, 
49313223960ull, 49526617140ull, 49749710010ull, 49788508770ull, 49866106290ull, 
49867127310ull, 49914604740ull, 50195895750ull, 50215295130ull, 50351090790ull, 
50603282730ull, 50642081490ull, 50736015330ull, 50816675910ull, 51029558580ull, 
51088267230ull, 51117366300ull, 51194963820ull, 51418056690ull, 51534452970ull, 
51757545840ull, 52019437470ull, 52097034990ull, 52201689540ull, 52320127860ull, 
52397725380ull, 52426824450ull, 52479316890ull, 52620818250ull, 52649917320ull, 
52779076350ull, 52873010190ull, 52882709880ull, 52950607710ull, 53164000890ull, 
53222199030ull, 53319195930ull, 53474390970ull, 53660396790ull, 53726582910ull, 
53794480740ull, 53823579810ull, 53988474540ull, 54141117030ull, 54155921820ull, 
54235050870ull, 54483158730ull, 54513398940ull, 54570455940ull, 54657753150ull, 
54851746950ull, 55006941990ull, 55103938890ull, 55327031760ull, 55414328970ull, 
55550124630ull, 55627722150ull, 55843667880ull, 55996310370ull, 56524688220ull, 
56529793320ull, 56806489740ull, 56865198390ull, 56888681850ull, 56936609730ull, 
57063276270ull, 57361113810ull, 57431864490ull, 57664657050ull, 57945948060ull, 
58227239070ull, 58497298860ull, 58498830390ull, 58567749240ull, 58634626050ull, 
58809220470ull, 58857718920ull, 58908259410ull, 58988379450ull, 59119610550ull, 
59255406210ull, 59342703420ull, 59575495980ull, 59633694120ull, 59694955320ull, 
59720991330ull, 59788889160ull, 59934384510ull, 60196276140ull, 60270300090ull, 
60422942580ull, 60610810260ull, 60661861260ull, 60904353510ull, 60951320430ull, 
61040149170ull, 61127446380ull, 61350539250ull, 61641529950ull, 61942220340ull, 
62087715690ull, 62165313210ull, 62242910730ull, 62446604220ull, 62636604030ull, 
62727895230ull, 62912189340ull, 63174651540ull, 63523269810ull, 63571768260ull, 
63581467950ull, 63746362680ull, 63804560820ull, 63853059270ull, 64015911960ull, 
64241046870ull, 64347743460ull, 64415641290ull, 64473839430ull, 64648433850ull, 
64683809190ull, 64696932300ull, 64790866140ull, 65037442470ull, 65812396650ull, 
66016090140ull, 66035489520ull, 66058972980ull, 66103387350ull, 66169573470ull, 
66258582390ull, 66384678360ull, 66413777430ull, 66452576190ull, 66481675260ull, 
66665969370ull, 66753266580ull, 67053956970ull, 67080503490ull, 67150953870ull, 
67228551390ull, 67360923630ull, 67471043640ull, 67655337750ull, 68256718530ull, 
68430802440ull, 68463264870ull, 68858099310ull, 68916297450ull, 68935696830ull, 
69158789700ull, 69478879470ull, 69624374820ull, 69760170480ull, 69804584850ull, 
70041461490ull, 70145095020ull, 70604043510ull, 70662241650ull, 70786055340ull, 
70943532660ull, 70962932040ull, 71166625530ull, 71263622430ull, 71612811270ull, 
71865003210ull, 72006504570ull, 72058997010ull, 72188156040ull, 72485783370ull, 
72505182750ull, 72854371590ull, 72869176380ull, 73174461360ull, 73397554230ull, 
73669145550ull, 73824340590ull, 73890706890ull, 73931037180ull, 73969835940ull, 
74066832840ull, 74270526330ull, 74289925710ull, 74513018580ull, 74542117650ull, 
74618694150ull, 74765210520ull, 74823408660ull, 74871907110ull, 75261035850ull, 
75267552360ull, 75405390060ull, 75473287890ull, 75676981380ull, 75851575800ull, 
76074668670ull, 76084368360ull, 76297761540ull, 76481485080ull, 76494608190ull, 
76520854410ull, 76676049450ull, 76792445730ull, 76802145420ull, 76955298420ull, 
77073736740ull, 77151334260ull, 77166649560ull, 77190133020ull, 77636318760ull, 
77894636820ull, 78305597370ull, 78480191790ull, 78596588070ull, 78974875980ull, 
79197968850ull, 79324064820ull, 79421061720ull, 79644154590ull, 79682953350ull, 
79867247460ull, 80019889950ull, 80167937850ull, 80332832580ull, 80360400120ull, 
80536526070ull, 80691721110ull, 80730519870ull, 80982711810ull, 81186405300ull, 
81293101890ull, 82389166860ull, 82583731230ull, 82980847950ull, 82990547640ull, 
83262138960ull, 83436733380ull, 83659826250ull, 83824720980ull, 83882919120ull, 
84106011990ull, 84309705480ull, 84446522160ull, 84668594010ull, 84697693080ull, 
84787032330ull, 84794689980ull, 85056581610ull, 85105080060ull, 85221476340ull, 
85538503050ull, 85890754950ull, 85902496680ull, 86282316120ull, 86336940690ull, 
86560033560ull, 86918922090ull, 87200213100ull, 87465528150ull, 88703665050ull, 
89004355440ull, 89014055130ull, 89363243970ull, 89433994650ull, 89450541180ull, 
89605736220ull, 89906426610ull, 90235195050ull, 90294414210ull, 90313243020ull, 
90505254840ull, 90507807390ull, 90575705220ull, 90798798090ull, 90856996230ull, 
90992791890ull, 91256725560ull, 91419578250ull, 91468076700ull, 91710568950ull, 
91914262440ull, 92137355310ull, 92263451280ull, 92544742290ull, 92583541050ull, 
92913330510ull, 93252819660ull, 93388615320ull, 93456513150ull, 93669906330ull, 
93854200440ull, 93951197340ull, 94084440450ull, 94368284010ull, 94591376880ull, 
94814469750ull, 95076361380ull, 95483748360ull, 95601856350ull, 95619544020ull, 
95638943400ull, 95706841230ull, 96023867940ull, 96201525420ull, 96458311950ull, 
96482816430ull, 96521615190ull, 96647711160ull, 96764107440ull, 97045398450ull, 
97326689460ull, 97726418790ull, 98567679210ull, 98607048540ull, 98626447920ull, 
98849540790ull, 98927138310ull, 99053234280ull, 99577017540ull, 99722512890ull, 
99829209480ull, 99858308550ull, 100129899870ull, 100430590260ull, 
100450500150ull, 100614884370ull, 100702181580ull, 100837977240ull, 
101206565460ull, 101284162980ull, 101507255850ull, 102176534460ull, 
102399627330ull, 102493561170ull, 103738184550ull, 104038874940ull, 
104358964710ull, 104640255720ull, 104795450760ull, 104853648900ull, 
105299834640ull, 105387131850ull, 105522927510ull, 105558152700ull, 
105765419760ull, 105969113250ull, 106179083010ull, 106444398060ull, 
106745088450ull, 107307670470ull, 107320793580ull, 107378120850ull, 
107453165820ull, 107588961480ull, 107647159620ull, 107976949080ull, 
108282234060ull, 108859620870ull, 109092413430ull, 109140911880ull, 
109761692040ull, 109984784910ull, 110207877780ull, 110430970650ull, 
110828657940ull, 110877156390ull, 110896555770ull, 111100249260ull, 
111255444300ull, 111687335760ull, 111769527870ull, 112027845930ull, 
112661899350ull, 113049376440ull, 113059586640ull, 113108085090ull, 
113360277030ull, 114126552540ull, 114446642310ull, 114551627190ull, 
114722227620ull, 114863728980ull, 115329314100ull, 115339013790ull, 
115785199530ull, 115891896120ull, 116113967970ull, 116173187130ull, 
116367180930ull, 116454478140ull, 116735769150ull, 117135498480ull, 
117317750550ull, 117569942490ull, 117715437840ull, 117976758900ull, 
118462313970ull, 118772704050ull, 118908499710ull, 118986097230ull, 
119150991960ull, 119267388240ull, 119354685450ull, 119389910640ull, 
119577778320ull, 119753904270ull, 119800871190ull, 120247056930ull, 
120392552280ull, 120540600180ull, 120809638950ull, 120881110350ull, 
122080298340ull, 122254892760ull, 122451739410ull, 122701078500ull, 
122924171370ull, 123283059900ull, 123884440680ull, 124185131070ull, 
124485821460ull, 124708914330ull, 124786511850ull, 124893208440ull, 
125155100070ull, 125207592510ull, 125737081470ull, 125824378680ull, 
126329273070ull, 126729873270ull, 127046539620ull, 127143536520ull, 
127192034970ull, 127492725360ull, 127706118540ull, 128031823920ull, 
128695486920ull, 128831282580ull, 128947678860ull, 129393864600ull, 
129616957470ull, 129774434790ull, 130063143210ull, 130286236080ull, 
130509328950ull, 130800319650ull, 131401700430ull, 131624793300ull, 
132206774700ull, 132740257650ull, 132769356720ull, 132963350520ull, 
133506533160ull, 134408604330ull, 134457102780ull, 134525000610ull, 
134942087280ull, 134971186350ull, 135300975810ull, 135469864530ull, 
135863557830ull, 136212746670ull, 136309743570ull, 136861604880ull, 
137221514430ull, 137225598510ull, 138317579400ull, 138395176920ull, 
138889861110ull, 139609169700ull, 139801631970ull, 139879229490ull, 
140082922980ull, 140325415230ull, 140630700210ull, 140926796010ull, 
141324483300ull, 141887065320ull, 141925864080ull, 142051960050ull, 
142110158190ull, 142333251060ull, 142497635280ull, 143225622540ull, 
144117994020ull, 144376312080ull, 144632077590ull, 144787272630ull, 
144971566740ull, 145233458370ull, 145708743180ull, 145990034190ull, 
146125829850ull, 146795108460ull, 147280663530ull, 147781413780ull, 
147910572810ull, 147939671880ull, 148133665680ull, 148240362270ull, 
148356758550ull, 148579851420ull, 149026037160ull, 149237388300ull, 
149249130030ull, 149365526310ull, 149443123830ull, 149530421040ull, 
149743814220ull, 149928108330ull, 150490690350ull, 150587687250ull, 
151053272370ull, 151809848190ull, 151848646950ull, 151926244470ull, 
152149337340ull, 152168736720ull, 153041708820ull, 153369786570ull, 
153570086670ull, 153710987430ull, 154147473480ull, 154333299120ull, 
154380266040ull, 154855550850ull, 154892067330ull, 155272637520ull, 
155495730390ull, 156834287610ull, 156960383580ull, 157193176140ull, 
157241674590ull, 157280473350ull, 157949751960ull, 158619030570ull, 
158648129640ull, 158842123440ull, 159511402050ull, 159666597090ull, 
159734494920ull, 160039779900ull, 160267977870ull, 160720800240ull, 
160869358650ull, 161061310410ull, 161073052140ull, 161461039740ull, 
161742330750ull, 163080887970ull, 163430076810ull, 164161127130ull, 
164273949840ull, 164419445190ull, 165167462460ull, 165311816670ull, 
165574278870ull, 165680404890ull, 165961695900ull, 165981095280ull, 
166204188150ull, 166650373890ull, 166873466760ull, 166883166450ull, 
167096559630ull, 167531003640ull, 167649441960ull, 168085928010ull, 
168212023980ull, 168619410960ull, 169337188020ull, 169395386160ull, 
169589379960ull, 170666045550ull, 171077006100ull, 171112231290ull, 
171189828810ull, 171868807110ull, 172896974250ull, 173120067120ull, 
173789345730ull, 174235531470ull, 174400426200ull, 174681717210ull, 
174701116590ull, 176043757890ull, 176427661410ull, 176573156760ull, 
176932045290ull, 176965138350ull, 177407330100ull, 178251203130ull, 
178901082360ull, 179448859590ull, 179812853220ull, 180009699870ull, 
180588828420ull, 181151410440ull, 181491920610ull, 181597596180ull, 
182266874790ull, 182936153400ull, 183054261390ull, 183120447510ull, 
183721828290ull, 183828524880ull, 184051617750ull, 184245611550ull, 
184274710620ull, 184924589850ull, 185089484580ull, 185167082100ull, 
185836360710ull, 186282546450ull, 186505639320ull, 186728732190ull, 
186777230640ull, 186913026300ull, 187339812660ull, 188184706710ull, 
188513475150ull, 188736568020ull, 188959660890ull, 189134255310ull, 
189628939500ull, 190345185030ull, 190569809430ull, 190744403850ull, 
190967496720ull, 190996595790ull, 191287586490ull, 192047735880ull, 
192975332550ull, 193421518290ull, 193809505890ull, 193945301550ull, 
194008604790ull, 194090796900ull, 194313889770ull, 195206261250ull, 
195452837580ull, 195678693210ull, 196059833970ull, 197437189950ull, 
197747580030ull, 198106468560ull, 198310162050ull, 198517429110ull, 
199154035080ull, 199221932910ull, 199445025780ull, 199658418960ull, 
199668118650ull, 199716617100ull, 200259799740ull, 200618688270ull, 
201006675870ull, 201229768740ull, 201452861610ull, 201675954480ull, 
202413130920ull, 202568325960ull, 203683790310ull, 204353068920ull, 
204987122340ull, 205623728310ull, 205914719010ull, 206807090490ull, 
207175678710ull, 207476369100ull, 207699461970ull, 207922554840ull, 
208051713870ull, 208591833450ull, 208717929420ull, 209280511440ull, 
209581201830ull, 209707297800ull, 210124384470ull, 210686966490ull, 
211116305400ull, 211385344170ull, 211986724950ull, 212358166020ull, 
212888796120ull, 213053690850ull, 213499876590ull, 213790867290ull, 
214615340940ull, 214838433810ull, 215750204670ull, 218000532750ull, 
218281823760ull, 218407919730ull, 218563114770ull, 219125696790ull, 
219280891830ull, 219523384080ull, 219804675090ull, 219969569820ull, 
220192662690ull, 222200498520ull, 222510888600ull, 222869777130ull, 
223539055740ull, 223762148610ull, 224055691860ull, 224155841910ull, 
224295631560ull, 224654520090ull, 224751516990ull, 226439263050ull, 
226720554060ull, 228224006010ull, 228253105080ull, 228670191750ull, 
229116377490ull, 229814755170ull, 230629529130ull, 230658628200ull, 
230678027580ull, 231570399060ull, 232227935940ull, 232346374260ull, 
232685863410ull, 232908956280ull, 233471538300ull, 234237813810ull, 
235139884980ull, 235440575370ull, 236924627940ull, 237335588490ull, 
237816999420ull, 237972194460ull, 238263185160ull, 238709370900ull, 
239048860050ull, 239601742380ull, 240059669850ull, 240251621610ull, 
240717206730ull, 242055763950ull, 242986934190ull, 244160596680ull, 
244509785520ull, 245664048630ull, 245848342740ull, 246566119800ull, 
247274197170ull, 247751193690ull, 247856178570ull, 248748550050ull, 
248912934270ull, 248942543850ull, 248971642920ull, 249786416880ull, 
250087107270ull, 250145305410ull, 251192871930ull, 251648757360ull, 
252318035970ull, 253210407450ull, 253443200010ull, 253703560110ull, 
254005782030ull, 254102778930ull, 254384069940ull, 258787729200ull, 
259010822070ull, 259233914940ull, 259548869580ull, 259631602230ull, 
259680100680ull, 260126286420ull, 260795565030ull, 261600639300ull, 
262134122250ull, 262347515430ull, 262580307990ull, 262803400860ull, 
263249586600ull, 263895381750ull, 264413549400ull, 265926701040ull, 
266110995150ull, 267013066320ull, 268516518270ull, 269273094090ull, 
269719279830ull, 270165465570ull, 270601951620ull, 270922041390ull, 
271523422170ull, 271727115660ull, 272396394270ull, 272619487140ull, 
274451197020ull, 276412065930ull, 276635158800ull, 276790353840ull, 
277634226870ull, 277750623150ull, 278138610750ull, 279218339400ull, 
279535366110ull, 279574164870ull, 279603263940ull, 279981551850ull, 
280650830460ull, 281009718990ull, 282134883030ull, 282648966600ull, 
283104852030ull, 283260047070ull, 283774130640ull, 283997223510ull, 
284666502120ull, 286451245080ull, 286751935470ull, 288323285250ull, 
289264155180ull, 289574545260ull, 291136195350ull, 291417486360ull, 
293211929010ull, 293590216920ull, 294941897250ull, 295562827560ull, 
295598052750ull, 295879343760ull, 296480724540ull, 296781414930ull, 
297159702840ull, 298052074320ull, 298731052620ull, 299167538670ull, 
299613724410ull, 299856216660ull, 300389699610ull, 300952281630ull, 
301592461170ull, 302795222730ull, 302960117460ull, 303619696380ull, 
303852488940ull, 304298674680ull, 305200745850ull, 306739573140ull, 
307140173340ull, 307421974860ull, 308207649750ull, 308760532080ull, 
310322182170ull, 310991460780ull, 311214553650ull, 311815934430ull, 
313668575220ull, 313920767160ull, 314483349180ull, 314560946700ull, 
314784039570ull, 315327222210ull, 315899503920ull, 316568782530ull, 
317014968270ull, 317296259280ull, 318537249030ull, 319333194180ull, 
319468989840ull, 320535955740ull, 321476825670ull, 321923011410ull, 
322922079480ull, 323242169250ull, 323484661500ull, 326578862610ull, 
327277240290ull, 328838890380ull, 329061983250ull, 329954354730ull, 
330177447600ull, 330516936750ull, 331360809780ull, 331923391800ull, 
332408376300ull, 333300747780ull, 333766332900ull, 334193119260ull, 
334862397870ull, 335062007280ull, 335308583610ull, 336424047960ull, 
337073927190ull, 337539512310ull, 338674376040ull, 338878069530ull, 
339178759920ull, 340080831090ull, 342224462580ull, 343737614220ull, 
345793948500ull, 346017041370ull, 347355598590ull, 347578691460ull, 
348519561390ull, 348800852400ull, 349022924250ull, 349101542790ull, 
349363434420ull, 351817455990ull, 352709827470ull, 353146313520ull, 
353311208250ull, 353864090580ull, 353930276700ull, 355386941910ull, 
355833127650ull, 356502406260ull, 356958291690ull, 357802164720ull, 
358064056350ull, 358897719180ull, 359625706440ull, 362302820880ull, 
363195192360ull, 365649213930ull, 365872306800ull, 366240895020ull, 
366987771150ull, 367443656580ull, 367880142630ull, 368549421240ull, 
368772514110ull, 369453534450ull, 369849179700ull, 370178969160ull, 
370334164200ull, 372710588250ull, 373457464380ull, 374126742990ull, 
374679625320ull, 377250043170ull, 377473136040ull, 378268510620ull, 
379927157610ull, 380373343350ull, 381576104910ull, 382575172980ull, 
383050457790ull, 387619011780ull, 388181593800ull, 388850872410ull, 
389323304370ull, 390189429630ull, 390635615370ull, 390858708240ull, 
392119667940ull, 392400958950ull, 394205101290ull, 394874379900ull, 
395495160060ull, 395989844250ull, 396620324100ull, 398308070160ull, 
398414766750ull, 398443865820ull, 400519599480ull, 402013351740ull, 
402459537480ull, 403575001830ull, 403652599350ull, 405805930530ull, 
405902927430ull, 407367580620ull, 407590673490ull, 408929230710ull, 
411160159410ull, 411247456620ull, 414904239750ull, 414952738200ull, 
416310694800ull, 417435858840ull, 419162403660ull, 419414595600ull, 
420530059950ull, 420976245690ull, 422232610800ull, 422770688340ull, 
423973449900ull, 426999753180ull, 427281044190ull, 428115217530ull, 
429230681880ull, 429676867620ull, 432800167800ull, 433896232770ull, 
434361817890ull, 435700375110ull, 436001065500ull, 436592746590ull, 
436815839460ull, 437126229540ull, 438251393580ull, 439939139640ull, 
440385325380ull, 444400997040ull, 444721086810ull, 445021777200ull, 
445739554260ull, 447524297220ull, 449309040180ull, 449503033980ull, 
449532133050ull, 452539036950ull, 452878526100ull, 453441108120ull, 
453547804710ull, 456448012020ull, 457340383500ull, 459629510340ull, 
460686776550ull, 461132962290ull, 461317256400ull, 461356055160ull, 
462723711450ull, 462917705250ull, 464455871880ull, 465817912560ull, 
468475627620ull, 470056677090ull, 470279769960ull, 470502862830ull, 
470881150740ull, 471725023770ull, 471841420050ull, 473849255880ull, 
475633998840ull, 475857091710ull, 475944388920ull, 476526370320ull, 
477418741800ull, 480503243220ull, 480803933610ull, 481434413460ull, 
485226992250ull, 488321193360ull, 489242663910ull, 491696685480ull, 
493132239600ull, 493258335570ull, 494635691550ull, 497041214670ull, 
497943285840ull, 498166378710ull, 499951121670ull, 500174214540ull, 
500649499350ull, 502385743860ull, 503074421850ull, 504257784030ull, 
504636071940ull, 508205557860ull, 509980601130ull, 512221229520ull, 
513336693870ull, 513782879610ull, 515606421330ull, 517234948230ull, 
518467829880ull, 518690922750ull, 519360201360ull, 520029479970ull, 
520252572840ull, 523201278600ull, 524268244500ull, 525606801720ull, 
526499173200ull, 527790763500ull, 528827098800ull, 530796135870ull, 
532522680690ull, 534753609390ull, 539438559660ull, 541203903240ull, 
543454231320ull, 544792788540ull, 545238974280ull, 546800624370ull, 
548808460200ull, 548902394040ull, 549361342530ull, 549923924550ull, 
552824131860ull, 554385781950ull, 555268453740ull, 555501246300ull, 
556277221500ull, 561301660920ull, 562019437980ull, 565113639090ull, 
566209704060ull, 566801385150ull, 567402765930ull, 567994447020ull, 
569333004240ull, 576646570500ull, 576695068950ull, 578528310360ull, 
579149090520ull, 580569839850ull, 581835904650ull, 582272390700ull, 
582834972720ull, 582941669310ull, 587180433840ull, 587849712450ull, 
588742083930ull, 591125655120ull, 592311569850ull, 592680158070ull, 
592961449080ull, 593242740090ull, 594319405680ull, 594542498550ull, 
594930486150ull, 597665798730ull, 599712433320ull, 600779399220ull, 
603020027610ull, 604358584830ull, 608597349360ull, 610401491700ull, 
611051370930ull, 614620856850ull, 614843949720ull, 616415299500ull, 
616871184930ull, 621982921560ull, 622429107300ull, 627337150440ull, 
627841534320ull, 628743605490ull, 628966698360ull, 629121893400ull, 
629344986270ull, 634029936540ull, 634156032510ull, 640499629770ull, 
641071911480ull, 643846022820ull, 644961487170ull, 645844158960ull, 
646969323000ull, 650315716050ull, 654001598250ull, 655689344310ull, 
657008502150ull, 657677780760ull, 658123966500ull, 658570152240ull, 
659908709460ull, 660577988070ull, 662721619560ull, 667532665800ull, 
671286445830ull, 672848095920ull, 673963560270ull, 677348752080ull, 
679317789150ull, 680161662180ull, 681548717850ull, 684448925160ull, 
684672018030ull, 686127992550ull, 689444265510ull, 691587897000ull, 
691975884600ull, 692034082740ull, 695157382920ull, 698726868840ull, 
700909299090ull, 705419654940ull, 707728181160ull, 710773883820ull, 
711666255300ull, 713004812520ull, 717795438360ull, 719251412880ull, 
723160387950ull, 723936363150ull, 726167291850ull, 726390384720ull, 
732481790040ull, 733975542300ull, 737098842480ull, 737545028220ull, 
738660492570ull, 741201811350ull, 746914928760ull, 749359250640ull, 
749640541650ull, 750261321810ull, 754946272080ull, 756537021240ull, 
756954107910ull, 760746686700ull, 762308336790ull, 768554937150ull, 
769893494370ull, 776363187600ull, 777478651950ull, 780378859260ull, 
782832880830ull, 784239335880ull, 784801917900ull, 786402366750ull, 
788410202580ull, 789748759800ull, 790990320120ull, 793521939210ull, 
796887731640ull, 801039198960ull, 804026703480ull, 804919074960ull, 
807305198700ull, 807373096530ull, 808711653750ull, 809157839490ull, 
811805854860ull, 815181346980ull, 817189182810ull, 817858461420ull, 
822989597430ull, 828402024450ull, 829236197790ull, 829905476400ull, 
834415832250ull, 836821355370ull, 841060119900ull, 841952491380ull, 
845541376680ull, 853999506360ull, 854562088380ull, 855561156450ull, 
858461363760ull, 860469199590ull, 864484871250ull, 868723635780ull, 
868946728650ull, 872002131000ull, 872962400310ull, 873408586050ull, 
874252459080ull, 879878279280ull, 880770650760ull, 889442173620ull, 
891256015650ull, 891479108520ull, 895048594440ull, 898618080360ull, 
899064266100ull, 905757052200ull, 906882216240ull, 912896024040ull, 
914680767000ull, 915602237550ull, 915883528560ull, 919811903010ull, 
921373553100ull, 922265924580ull, 922712110320ull, 925166131890ull, 
933643660950ull, 940559539920ull, 941005725660ull, 941762301480ull, 
943682840100ull, 947106830670ull, 947698511760ull, 949706347590ull, 
951044904810ull, 951267997680ull, 954168204990ull, 965769034230ull, 
970453984500ull, 983393370960ull, 988970692710ull, 989863064190ull, 
990532342800ull, 994082429340ull, 996109664550ull, 996332757420ull, 
998786778990ull, 1005033379350ull, 1006148843700ull, 1009272143880ull, 
1016634208590ull, 1019961202260ull, 1020242493270ull, 1027565759220ull, 
1037381845500ull, 1037682535890ull, 1038051124110ull, 1040058959940ull, 
1040505145680ull, 1046402557200ull, 1048536489000ull, 1051213603440ull, 
1058129482410ull, 1067499382950ull, 1069507218780ull, 1078877119320ull, 
1086908462640ull, 1089585577080ull, 1090002663750ull, 1090477948560ull, 
1093378155870ull, 1097616920400ull, 1098722685060ull, 1099847849100ull, 
1100963313450ull, 1106317542330ull, 1106763728070ull, 1114348885650ull, 
1122380228970ull, 1122603321840ull, 1123272600450ull, 1132196315250ull, 
1132419408120ull, 1133602770300ull, 1141120030050ull, 1141566215790ull, 
1143350958750ull, 1153390137900ull, 1159762834230ull, 1160752202610ull, 
1164544781400ull, 1168783545930ull, 1175699424900ull, 1177202876850ull, 
1177484167860ull, 1180384375170ull, 1182615303870ull, 1185922898160ull, 
1189084997100ull, 1195331597460ull, 1207378612440ull, 1209832634010ull, 
1210278819750ull, 1220802983400ull, 1222772020470ull, 1226787692130ull, 
1229241713700ull, 1243965843120ull, 1244858214600ull, 1247758421910ull, 
1254674300880ull, 1258243786800ull, 1261590179850ull, 1262928737070ull, 
1268059873080ull, 1268729151690ull, 1275868123530ull, 1280999259540ull, 
1281843132570ull, 1287692045640ull, 1293269367390ull, 1293938646000ull, 
1307101125330ull, 1307993496810ull, 1308003196500ull, 1310670611250ull, 
1314017004300ull, 1319817418920ull, 1321155976140ull, 1325443239120ull, 
1334163260430ull, 1348596399150ull, 1352165885070ull, 1358635578300ull, 
1360323324360ull, 1363097435700ull, 1369344036060ull, 1371798057630ull, 
1383175794000ull, 1384068165480ull, 1390314765840ull, 1394553530370ull, 
1394999716110ull, 1397453737680ull, 1410170031270ull, 1410839309880ull, 
1411508588490ull, 1415524260150ull, 1423332510600ull, 1426009625040ull, 
1426901996520ull, 1429802203830ull, 1445418704730ull, 1455680976750ull, 
1464963580080ull, 1467727991730ull, 1473683601390ull, 1475090056440ull, 
1482403622700ull, 1491123644010ull, 1493829857520ull, 1494499136130ull, 
1513908215820ull, 1521493373400ull, 1526003729250ull, 1528409252370ull, 
1536663688560ull, 1539786988740ull, 1543579567530ull, 1545810496230ull, 
1554957303900ull, 1556072768250ull, 1560088439910ull, 1565665761660ull, 
1569603835800ull, 1576820405160ull, 1585074841350ull, 1587043878420ull, 
1597568042070ull, 1598014227810ull, 1617423307500ull, 1618315678980ull, 
1621215886290ull, 1630362693960ull, 1634378365620ull, 1640401873110ull, 
1648084027590ull, 1649771773650ull, 1650887238000ull, 1656804048900ull, 
1673642710740ull, 1682120239800ull, 1683904982760ull, 1694390347650ull, 
1700404155450ull, 1707999012720ull, 1708222105590ull, 1709124176760ull, 
1710453034290ull, 1720938399180ull, 1725177163710ull, 1728969742500ull, 
1737893457300ull, 1746817172100ull, 1763549137350ull, 1766226251790ull, 
1779165638250ull, 1782958217040ull, 1798128532200ull, 1811514104400ull, 
1824230397990ull, 1825792048080ull, 1829361534000ull, 1843862570550ull, 
1850332263780ull, 1865948764680ull, 1867287321900ull, 1869741343470ull, 
1882011451320ull, 1888034958810ull, 1901866716750ull, 1902089809620ull, 
1911682803030ull, 1921498889310ull, 1931538068460ull, 1940907969000ull, 
1971025506450ull, 1977941385420ull, 1979726128380ull, 1992665514840ull, 
1997573557980ull, 1998689022330ull, 2018544287760ull, 2037953367450ull, 
2038845738930ull, 2054016054090ull, 2074763691000ull, 2080117919880ull, 
2089710913290ull, 2102650299750ull, 2116258964820ull, 2134998765900ull, 
2157754238640ull, 2178501875550ull, 2179171154160ull, 2186756311740ull, 
2199695698200ull, 2212635084660ull, 2219104777890ull, 2228697771300ull, 
2233828907310ull, 2247660665250ull, 2264392630500ull, 2270862323730ull, 
2282240060100ull, 2309680483110ull, 2329089562800ull, 2335559256030ull, 
2337567091860ull, 2348498642490ull, 2351398849800ull, 2354968335720ull, 
2360768750340ull, 2365230607740ull, 2372146486710ull, 2385532058910ull, 
2419665268020ull, 2426134961250ull, 2427473518470ull, 2445544040940ull, 
2451567548430ull, 2458483427400ull, 2468968792290ull, 2489716429200ull, 
2490831893550ull, 2496632308170ull, 2510464066110ull, 2523180359700ull, 
2525857474140ull, 2536119746160ull, 2561998519080ull, 2581407598770ull, 
2586538734780ull, 2593454613750ull, 2614202250660ull, 2628034008600ull, 
2639634837840ull, 2662613403450ull, 2697192798300ull, 2704331770140ull, 
2717271156600ull, 2738688072120ull, 2749619622750ull, 2759435709030ull, 
2775498395670ull, 2821678619760ull, 2846665021200ull, 2853134714430ull, 
2859604407660ull, 2890837409460ull, 2911361953500ull, 2939248562250ull, 
2943710419650ull, 2950180112880ull, 2966912078130ull, 2969589192570ull, 
2988998272260ull, 3027816431640ull, 3042986746800ull, 3049902625770ull, 
3056818504740ull, 3073104284250ull, 3079573977480ull, 3112145536500ull, 
3131331523320ull, 3146724931350ull, 3153640810320ull, 3170149682700ull, 
3174388447230ull, 3196028455620ull, 3202498148850ull, 3234846615000ull, 
3236631357960ull, 3260725387920ull, 3280134467610ull, 3285042510750ull, 
3299543547300ull, 3318952626990ull, 3347285421480ull, 3364240479600ull, 
3396588945750ull, 3416444211180ull, 3423360090150ull, 3441876798360ull, 
3457939485000ull, 3487164650970ull, 3493634344200ull, 3506350637790ull, 
3527098274700ull, 3532452503580ull, 3547845911610ull, 3558331276500ull, 
3596257064400ull, 3629497902030ull, 3630836459250ull, 3687725141100ull, 
3700664527560ull, 3727658764830ull, 3734574643800ull, 3739482686940ull, 
3784770539550ull, 3803733433500ull, 3804179619240ull, 3842997778620ull, 
3849467471850ull, 3879808102170ull, 3881815938000ull, 3914164404150ull, 
3942051012900ull, 3955882770840ull, 3959452256760ull, 3985331029680ull, 
3997378044660ull, 4045789197450ull, 4056497655210ull, 4075906734900ull, 
4108032108180ull, 4114947987150ull, 4121194587510ull, 4149527382000ull, 
4179421826580ull, 4184106776850ull, 4205300599500ull, 4232517929640ull, 
4269997531800ull, 4289406611490ull, 4302345997950ull, 4367042930250ull, 
4373512623480ull,
};


/* All the prime factors that can appear in eulerphi(P) */
const unsigned long phiPfactors[] = {2UL, 3UL, 5UL, 7UL, 11UL, 13UL, 
				     17UL, 19UL, 23UL, 29UL, 37UL,
				     41UL, 43UL, 53UL, 83UL, 89UL, 113UL};

/* returns Euler's totient phi function */
uint64_t
eulerphi64 (uint64_t n)
{
  uint64_t phi = 1, p;

  for (p = 2UL; p * p <= n; p += 2)
    {
      if (n % p == 0)
	{
	  phi *= p - 1;
	  n /= p;
	  while (n % p == 0)
	    {
	      phi *= p;
	      n /= p;
	    }
	}

      if (p == 2UL)
	p--;
    }

  /* now n is prime or 1 */
  return (n == 1) ? phi : phi * (n - 1);
}

/* Approximate amount of memory in bytes each coefficient in an NTT takes 
   so that NTT can do transforms up to length lmax with modulus, or
   with 2*modulus if twice != 0 */
static size_t
ntt_coeff_mem (const uint64_t lmax, const mpz_t modulus, const int twice)
{
  mpz_t t, ltmp;
  size_t n;
  
  mpz_init (t);
  mpz_init (ltmp);
  mpz_mul (t, modulus, modulus);
  mpz_set_uint64 (ltmp, lmax);
  mpz_mul (t, t, ltmp);
  if (twice)
    mpz_mul_2exp (t, t, 1UL);
  /* +4: +1 for rounding up, +3 for extra words due to ECRT */
  n = (mpz_sizeinbase (t, 2) - 1) / SP_NUMB_BITS + 4;
  mpz_clear (t);
  mpz_clear (ltmp);
  return n * sizeof (sp_t);
}

size_t
pm1fs2_memory_use (const uint64_t lmax, const mpz_t modulus, 
		   const int use_ntt)
{
  if (use_ntt)
    {
      /* We store lmax / 2 + 1 coefficients for the DCT-I of F and lmax 
	 coefficients for G in NTT ready format. Each coefficient in 
	 NTT-ready format occupies approx. 
	 ceil(log(lmax*modulus^2)/log(bits per sp_t)) + 3 words. */
      
      size_t n;
      
      n = ntt_coeff_mem (lmax, modulus, 0) * (size_t) (3 * lmax / 2 + 1);
      outputf (OUTPUT_DEVVERBOSE, "pm1fs2_memory_use: Estimated memory use "
	       "with lmax = %lu NTT is %lu bytes\n", lmax, n);
      return n;
    }
  else
    {
      /* F stores s_1/2 residues,
	 h stores s_1 mpz_t structs (residues get cloned from F)
	 g stores lmax residues, 
	 R stores lmax-s_1 residues, 
	 and tmp stores 3*lmax+list_mul_mem (lmax / 2) residues.
	 Assume s_1 is close to lmax/2.
	 Then we have 
	 lmax/4 + lmax/2 + lmax + lmax/2 + 3*lmax + list_mul_mem (lmax / 2)
	 = (5+1/4)*lmax + list_mul_mem (lmax / 2) residues, plus s_1 mpz_t.
      */
      
      size_t n;
      
      n = mpz_size (modulus) * sizeof (mp_limb_t) + sizeof (mpz_t);
      n *= 5 * lmax + lmax / 4 + list_mul_mem (lmax / 2);
      n += lmax / 2 * sizeof (mpz_t);
      /* Memory use due to temp space allocation in TMulKS appears to 
	 approximately triple the estimated memory use. This is hard to
	 estimate precisely, so let's go with the fudge factor of 3 here */
      n *= 3;
      outputf (OUTPUT_DEVVERBOSE, "pm1fs2_memory_use: Estimated memory use "
	       "with lmax = %lu is %lu bytes\n", lmax, n);
      return n;
    }
}

/* return the possible lmax for given memory use and modulus */

unsigned long
pm1fs2_maxlen (const size_t memory, const mpz_t modulus, const int use_ntt)
{
  if (use_ntt)
    {
      size_t n, lmax = 1;
  
      n = ntt_coeff_mem (lmax, modulus, 0);
      lmax = 1UL << ceil_log2 (memory / n / 3);
      return lmax;
    }
  else
    {
      size_t lmax, n;
      
      n = mpz_size (modulus) * sizeof (mp_limb_t) + sizeof (mpz_t);

      /* Guess an initial value of lmax for list_mul_mem (lmax / 2) */
      /* memory = n * 25/4 * lmax + lmax / 2 * sizeof (mpz_t); */
      /* Fudge factor of 3 for TMulKS as above */
      lmax = memory / (3 * 25 * n / 4 + 3 * sizeof (mpz_t) / 2);
      return lmax;
    }
}

size_t 
pp1fs2_memory_use (const uint64_t lmax, const mpz_t modulus, 
		   const int use_ntt, const int twopass)
{
  size_t n, m;
  
  m = mpz_size (modulus) * sizeof (mp_limb_t) + sizeof (mpz_t);
  if (use_ntt)
    {
      /* In one pass mode, we store h_x_ntt and h_y_ntt, each of length 
	 lmax/2(+1), and g_x_ntt and g_y_ntt, each of length lmax, all in 
	 NTT ready format. In two pass mode, we store h_x_ntt, h_y_ntt and 
	 g_x_ntt as before, plus R which is lmax - s_1 mpz_t. 
	 We assume s_1 ~= lmax/2.
      */

      n = ntt_coeff_mem (lmax, modulus, !twopass);
      if (twopass)
	return lmax * (2 * n + m / 2);
      else
	return lmax * 3 * n;
    }
  else
    {
      /* We allocate:
	 F: s_1/2 coefficients
	 fh_x, fh_y: s_1/2 coefficients
	 h_x, h_y: s_1 mpz_t's (cloned from fh_x and fh_y)
	 g_x, g_y: lmax coefficients
	 R_x, R_y: lmax - s_1 coefficients
	 tmp: 3UL * lmax + list_mul_mem (lmax / 2)
	 Assuming s_1 ~ lmax/2, that's
	 lmax/2 + 2*lmax/4 + 2*lmax + 2*lmax/2 * 3*lmax + 
           list_mul_mem (lmax / 2) =
	 7 + list_mul_mem (lmax / 2) coefficients and lmax mpz_t.
       */
      
      n = m * (7 * lmax + list_mul_mem (lmax / 2));
      n += lmax * sizeof (mpz_t);
      n = 5 * n / 2; /* A fudge factor again */
      return n;
    }
}

unsigned long 
pp1fs2_maxlen (const size_t memory, const mpz_t modulus, const int use_ntt, 
	       const int twopass)
{
  size_t n, m;
  
  m = mpz_size (modulus) * sizeof (mp_limb_t) + sizeof (mpz_t);
  if (use_ntt)
    {
      n = ntt_coeff_mem (1, modulus, !twopass);
      if (twopass)
	n = memory / (2 * n + m / 2);
      else
	n = memory / (3 * n);
      return 1UL << (ceil_log2 (n / 2)); /* Rounded down to power of 2 */
    }
  else
    {
      return memory / 5 / (m * 8 + sizeof (mpz_t)) * 2;
    }
}


/* Test if for given P, nr, B2min and B2 we can choose an m_1 so that the 
   stage 2 interval [B2min, B2] is covered. The effective B2min and B2
   are stored in effB2min and effB2 */

static int
test_P (const mpz_t B2min, const mpz_t B2, mpz_t m_1, const uint64_t P, 
	const uint64_t nr, mpz_t effB2min, mpz_t effB2)
{
  mpz_t m, Ptmp, nrtmp;
  /* We need B2min >= max(S_1 + S_2) + (m_1 - 1) * P + 1, or
     B2min - max(S_1 + S_2) - 1 >= m_1*P - P, or
     (B2min - max(S_1 + S_2) - 1)/P + 1 >= m_1
     Choose m_1 accordingly */
  
  mpz_init (m);
  mpz_init (Ptmp);
  mpz_init (nrtmp);
  sets_get_factored_sorted (NULL, m, P);
  mpz_mul_2exp (m, m, 1UL); /* m = 2*max(S_1 + S_2) */

  mpz_sub (m_1, B2min, m);
  mpz_sub_ui (m_1, m_1, 1UL); /* m_1 = B2min - max(S_1 + S_2) - 1 */
  mpz_set_uint64 (Ptmp, P);
  mpz_fdiv_q (m_1, m_1, Ptmp);
  mpz_add_ui (m_1, m_1, 1);
  
  /* Compute effB2min = max(S_1 + S_2) + (m_1 - 1)*P + 1 */
  
  mpz_sub_ui (effB2min, m_1, 1UL);
  mpz_mul (effB2min, effB2min, Ptmp);
  mpz_add (effB2min, effB2min, m);
  mpz_add_ui (effB2min, effB2min, 1UL);
  ASSERT_ALWAYS (mpz_cmp (effB2min, B2min) <= 0);

  /* Compute the smallest value coprime to P at the high end of the stage 2
     interval that will not be covered: 
     min(S_1 + S_2) + (m_1 + nr)*P. 
     We assume min(S_1 + S_2) = -max(S_1 + S_2) */
  mpz_set_uint64 (nrtmp, nr);
  mpz_add (effB2, m_1, nrtmp);
  mpz_mul (effB2, effB2, Ptmp);
  mpz_sub (effB2, effB2, m);

  /* The effective B2 values is that value, minus 1 */
  mpz_sub_ui (effB2, effB2, 1UL);

  mpz_clear (m);
  mpz_clear (Ptmp);
  mpz_clear (nrtmp);
  return (mpz_cmp (B2, effB2) <= 0);
}


static void
factor_phiP (int *exponents, const uint64_t phiP)
{
    const int nrprimes = sizeof (phiPfactors) / sizeof (unsigned long);
    uint64_t cofactor = phiP;
    int i;
    
    ASSERT_ALWAYS (phiP > 0);

    for (i = 0; i < nrprimes; i++)
	for (exponents[i] = 0; cofactor % phiPfactors[i] == 0UL; exponents[i]++)
	    cofactor /= phiPfactors[i];

    ASSERT_ALWAYS (cofactor == 1UL);
}


static unsigned long 
pow_ul (const unsigned long b, const unsigned int e)
{
    unsigned long r = 1UL;
    unsigned int i;

    for (i = 0; i < e; i++)
	r *= b;

    return r;
}

static uint64_t
absdiff_ul (uint64_t a, uint64_t b)
{
    return (a > b) ? a - b : b - a;
}

/* Choose s_1 so that s_1 * s_2 = phiP, s_1 is positive and even, 
   s_2 >= min_s2 and s_2 is minimal and abs(s_1 - l) is minimal 
   under those conditions. If use_ntt == 1, we require s_1 < l.
   Returns 0 if no such choice is possible */

static uint64_t
choose_s_1 (const uint64_t phiP, const uint64_t min_s2,
	    const uint64_t l, const int use_ntt)
{
  const int nrprimes = sizeof (phiPfactors) / sizeof (unsigned long);
  /* Using [nrprimes] here makes the compiler complain about variable-sized
     arrays */
  int phiPexponents[sizeof (phiPfactors) / sizeof (unsigned long)], 
    exponents[sizeof (phiPfactors) / sizeof (unsigned long)];
  uint64_t s_1 = 0UL, s_2 = 0UL, trys_1;
  int i;

  ASSERT_ALWAYS (phiP > 0 && phiP % 2 == 0);

  /* We want only even s_1. We divide one 2 out of phiP here... */
  factor_phiP (phiPexponents, phiP / 2);
  for (i = 0; i < nrprimes; i++)
      exponents[i] = 0;

  do {
      trys_1 = 2; /* ... and add a 2 here */
      for (i = 0; i < nrprimes; i++)
	  trys_1 *= pow_ul (phiPfactors[i], exponents[i]);
#if 0
      printf ("choose_s_1: Trying trys_1 = %" PRId64 "\n", trys_1);
#endif
      /* See if it satisfies all the required conditions and is an 
	 improvement over the previous choice */
      if (phiP / trys_1 >= min_s2 && 
	  (s_2 == 0 || phiP / trys_1 < s_2) && 
	  absdiff_ul (trys_1, l) < absdiff_ul (s_1, l) &&
	  (use_ntt == 0 || trys_1 < l))
      {
#if 0
	  printf ("choose_s_1: New best s_1 for "
	          "phiP = %" PRId64 ", min_s2 = %" PRId64 
		  ", l = %" PRId64 " : %" PRId64 "\n", 
                  phiP, min_s2, l, trys_1);
#endif
	  s_1 = trys_1;
      }
      for (i = 0; i < nrprimes; i++)
      {
	  if (++(exponents[i]) <= phiPexponents[i])
	      break;
	  exponents[i] = 0;
      }
  } while (i < nrprimes);

  return s_1;
}


/* Approximate cost of stage 2. Cost with and without ntt are not 
   comparable. We have l > s_1 and s_1 * s_2 = eulerphi(P), hence
   s_2*l > eulerphi(P) and so cost (s_2, l) > eulerphi(P) for all P */
static uint64_t
est_cost (const uint64_t s_2, const uint64_t l, const int use_ntt,
          const int method)
{
  if (method == ECM_PM1)
    {
      /* The time for building f, h and DCT-I of h seems to be about 
         7/6 of the time of computing g, h*g and gcd with NTT, and 
         3/2 of the time of computing g, h*g and gcd without NTT */

      if (use_ntt)
        return (7 * l) / 6 + s_2 * l;
      else
        return (3 * l) / 2 + s_2 * l;
    }
  else if (method == ECM_PP1)
    {
      /* Building f is the same, building h and its forward transform is
         twice about as expensive as for P-1. Each multi-point evaluation
         is twice as expensive as for P-1.
         FIXME: The estimate for NTT assumes the "one-pass" variant, in 
         "two-pass" the multipoint evaluations are slower, so the optimum 
         shifts towards smaller s_2 some more */
      if (use_ntt)
        return (4 * l) / 5 + s_2 * l;
      else
        return (3 * l) / 4 + s_2 * l;
    }
  else
    abort (); /* Invalid value for method */
}

/* Choose P so that a stage 2 range from B2min to B2 can be covered with
   multipoint evaluations, each using a convolution of length at most lmax. 
   The parameters for stage 2 are stored in finalparams, the final effective
   B2min and B2 values in final_B2min and final_B2, respecively. Each of these
   may be NULL, in which case the value is not stored. It is permissible
   to let B2min and final_B2min, or B2 and final_B2 point at the same mpz_t. */

long
choose_P (const mpz_t B2min, const mpz_t B2, const uint64_t lmax,
	  const uint64_t min_s2, faststage2_param_t *finalparams, 
	  mpz_t final_B2min, mpz_t final_B2, const int use_ntt, 
	  const int method)
{
  /* Let S_1 + S_2 == (Z/PZ)* (mod P).

     Let F(x) = \prod_{k_1 \in S_1} (x - b_1^{k_1}).

     If we evaluate F(b_1^{k_2 + m P}) for all k_2 \in S_2 with 
     m_1 <= m < m_1+nr, we test all exponents k_2 + m P - k_1.
     The largest value coprime to P at the low end of the stage 2 interval 
     *not* covered will be 
       max(S_2) + (m_1 - 1)*P - min(S_1).
     The smallest value at the high end not covered will be
       min(S_2) + (m_1 + nr)*P - max(S_1).
     Assume S_1 and S_2 are symmetric around 0, so that max(S_1) = -min(S_1).
     Then the largest ... is:
       max(S_1) + max(S_2) + (m_1 - 1)*P
     The smallest ... is:
       -(max(S_1) + max(S_2)) + (m_1 + nr)*P
     The effective B2min = (max(S_1) + max(S_2)) + (m_1 - 1)*P + 1
     The effective B2max = -(max(S_1) + max(S_2)) + (m_1 + nr)*P - 1

     Then the difference effB2max - effB2min =
       -2*(max(S_1) + max(S_2)) + P*(nr + 1) - 2

     We obviously require B2max - B2min <= nr*P
     Since nr < lmax, B2max - B2min <= lmax*P or
     P >= ceil((B2max - B2min)/lmax)

     Hence we are looking for an odd P with s_1 * s_2 = eulerphi(P) so that
     s_1 ~= lmax / 2 and the whole stage 2 interval is covered. s_2 should 
     be small, as long as s_1 is small enough.
  */

  mpz_t B2l, m_1, effB2min, tryeffB2, effB2, lmin, Ptmp;
  /* The best parameters found so far, P == 0 means that no suitable P
     has been found yet: */
  uint64_t P = 0, s_1 = 0, s_2 = 0, cost = 0, l = 0;
  unsigned int i;
  const unsigned int Pvalues_len = sizeof (Pvalues) / sizeof (uint64_t);
  int r;

  outputf (OUTPUT_TRACE, "choose_P(B2min = %Zd, B2 = %Zd, ", B2min, B2);
  outputf (OUTPUT_TRACE, "lmax = %" PRId64 ", min_s2 = %" PRId64 
          ", use_ntt = %d, method = %d\n", lmax, min_s2, use_ntt, method);

  if (mpz_cmp (B2, B2min) < 0)
    return 0L;

  /* If we use the NTT, we allow only power-of-two transform lengths.
     In that case, the code below assumes that lmax is a power of two.
     If that is not the case, print error and return. */
  if (use_ntt && (lmax & (lmax - 1UL)) != 0)
    {
      outputf (OUTPUT_ERROR, 
               "choose_P: Error, lmax = %lu is not a power of two\n", lmax);
      return ECM_ERROR;
    }
  
  mpz_init (effB2);
  mpz_init (tryeffB2);
  mpz_init (effB2min);
  mpz_init (B2l);
  mpz_init (m_1);
  mpz_init (lmin);
  mpz_init (Ptmp);
  
  mpz_sub (B2l, B2, B2min);
  mpz_add_ui (B2l, B2l, 1UL); /* +1 due to closed interval */
  
  /* For each candidate P, check if [B2min, B2] can be covered at all,
     and if so, what the best parameters (minimizing the cost, maximizing 
     effB2) are. If they are better than the best parameters for the best P 
     so far, remember them. */

  for (i = 0 ; i < Pvalues_len; i++)
    {
      uint64_t tryP, tryphiP, trys_1, trys_2, trycost, tryl;
      
      tryP = Pvalues[i];
      tryphiP = eulerphi64 (tryP);
      
      outputf (OUTPUT_TRACE, 
	       "choose_P: trying P = %" PRId64 ", eulerphi(P) = "
	       "%" PRId64 "\n", tryP, tryphiP);
      
      /* If we have a good P already and this tryphiP >= cost, then 
	 there's no hope for this tryP, since cost(s_2, l) > eulerphi(P) */
      if (P != 0 && tryphiP >= cost)
	{
	  outputf (OUTPUT_TRACE, 
		   "choose_P: tryphiP > cost = %" PRId64 
		   ", this P is too large\n", cost);
	  continue;
	}
      
      /* We have nr < l and effB2-effB2min <= nr*P. Hence we need 
	 l >= B2l/P */
      mpz_set_uint64(Ptmp, tryP);
      mpz_cdiv_q (lmin, B2l, Ptmp);
      outputf (OUTPUT_TRACE, "choose_P: lmin = %Zd for ", lmin);
      outputf (OUTPUT_TRACE, "P = %" PRId64 "\n", tryP);
      if (mpz_cmp_ui (lmin, lmax) > 0)
	{
	  outputf (OUTPUT_TRACE, 
		   "choose_P: lmin > lmax, this P is too small\n");
	  continue;
	}
      
      /* Try all possible transform lengths and store parameters in 
	 P, s_1, s_2, l if they are better than the previously best ones */
       
      /* Keep reducing tryl to find best parameters. For NTT, we only have 
	 power of 2 lengths so far, so we can simply divide by 2. 
	 For non-NTT, we have arbitrary transform lengths so we can decrease 
	 in smaller steps... let's say by, umm, 25% each time? */
      for (tryl = lmax; mpz_cmp_ui (lmin, tryl) <= 0;
	   tryl = (use_ntt) ? tryl / 2 : 3 * tryl / 4)
	{
	  trys_1 = choose_s_1 (tryphiP, min_s2, tryl / 2, use_ntt);
	  if (trys_1 == 0)
	    {
	      outputf (OUTPUT_TRACE, 
		       "choose_P: could not choose s_1 for "
		       "P = %" PRId64 ", l = %lu\n", tryP, tryl);
	      continue;
	    }
	  ASSERT (tryphiP % trys_1 == 0UL);
	  trys_2 = tryphiP / trys_1;
	  outputf (OUTPUT_TRACE, 
	      	"choose_P: chose s_1 = %" PRId64 ", k = s_2 = %" PRId64 
		   " for P = %" PRId64 ", l = %" PRId64 "\n", 
		   trys_1, trys_2, tryP, tryl);
	  
	  if (test_P (B2min, B2, m_1, tryP, tryl - trys_1, effB2min, tryeffB2))
	    {
	      /* can't mix 64-bit types and mpz_t on win32 for some reason */
	      outputf (OUTPUT_TRACE, 
		       "choose_P: P = %" PRId64 ", l = %" PRId64 ", "
		       "s_1 = %" PRId64 ", k = s_2 = %" PRId64 " works, ",
		       tryP, tryl, trys_1, trys_2);
	      outputf (OUTPUT_TRACE, 
		       "m_1 = %Zd, effB2min = %Zd, effB2 = %Zd\n",
		       m_1, effB2min, tryeffB2);
	      /* We use these parameters if we 
		 1. didn't have any suitable ones yet, or 
		 2. these cover [B2min, B2] and are cheaper than the best 
                    ones so far, or 
		 3. they are as expensive but reach greater effB2. */
	      trycost = est_cost (trys_2, tryl, use_ntt, method);
	      ASSERT (tryphiP < trycost);
	      if (P == 0 || trycost < cost ||
		  (trycost == cost && mpz_cmp (tryeffB2, effB2) > 0))
		{
		  outputf (OUTPUT_TRACE, 
			   "choose_P: and is the new "
			   "optimum (cost = %" PRId64 ")\n", trycost);
		  P = tryP;
		  s_1 = trys_1;
		  s_2 = trys_2;
		  l = tryl;
		  cost = trycost;
		  mpz_set (effB2, tryeffB2);
		}
	    }
	}
  }
  
  if (P != 0) /* If we found a suitable P */
    {
      /* Compute m_1, effB2min, effB2 again */
      r = test_P (B2min, B2, m_1, P, l - s_1, effB2min, effB2);
      ASSERT_ALWAYS(r != 0);
      if (finalparams != NULL)
	{
	  finalparams->P = P;
	  finalparams->s_1 = s_1;
	  finalparams->s_2 = s_2;
	  finalparams->l = l;
	  mpz_set (finalparams->m_1, m_1);
	}
      if (final_B2min != NULL)
	mpz_set (final_B2min, effB2min);
      if (final_B2 != NULL)
	mpz_set (final_B2, effB2);
    }
  
  mpz_clear (effB2);
  mpz_clear (tryeffB2);
  mpz_clear (effB2min);
  mpz_clear (B2l);
  mpz_clear (m_1);
  mpz_clear (lmin);
  mpz_clear (Ptmp);

  return (P != 0) ? (long) P : ECM_ERROR;
}
